{"version":3,"sources":["serivce/localStorage.js","serivce/API.js","context/UserContext.js","components/share/Share.jsx","hooks/useIntersectionObserver.js","components/post/Post.jsx","components/feed/Feed.jsx","components/online/Online.jsx","hooks/useFetchData.js","components/userbox/Userbox.jsx","components/rightbar/Rightbar.jsx","components/topbar/Topbar.jsx","components/layout/Layout.jsx","pages/home/photos/Image.jsx","pages/home/photos/index.jsx","hooks/useFetchPostsPhoto.js","components/timeline/index.jsx","components/filter/index.jsx","pages/home/Home.jsx","pages/profile/Profile.jsx","pages/login/Login.jsx","pages/register/Register.jsx","pages/setting/Setting.jsx","pages/404/NoFound.js","components/protectedroute/index.js","App.js","index.js"],"names":["Storage","set","key","value","localStorage","setItem","JSON","stringify","get","parse","getItem","remove","removeItem","clear","http","axios","create","baseURL","process","timeout","interceptors","request","use","config","headers","Authorization","response","res","err","console","log","toast","data","message","Promise","reject","INITIAL_STATE","user","UserContext","createContext","UserContextProvider","children","useState","setUser","Provider","Share","username","desc","useRef","file","setFile","useContext","setHide","format","text","replace","submitHandler","e","a","preventDefault","newPost","userId","_id","current","FormData","fileName","Date","now","name","append","post","imgURL","img","window","location","reload","useEffect","handler","document","addEventListener","keydownHandler","keyCode","ctrlKey","removeEventListener","ShareComponent","className","src","alt","type","placeholder","ref","URL","createObjectURL","onSubmit","htmlFor","PermMedia","htmlColor","id","style","display","accept","onChange","target","files","undefined","observer","listenerCallbacks","WeakMap","handleIntersections","entries","forEach","entry","has","cb","isIntersecting","intersectionRatio","dataset","unobserve","delete","getIntersectionObserver","IntersectionObserver","rootMargin","threshold","useIntersection","elem","callback","observe","Post","likes","length","visible","setVisible","imgRef","currentUser","fetchUser","handlerDelete","alert","deletePost","onClick","put","followUser","unFollowUser","to","profilePicture","createdAt","MoreVert","nativeEvent","stopImmediatePropagation","dangerouslySetInnerHTML","__html","data-src","Feed","posts","setPosts","SearchKey","useLocation","search","split","pop","flat","sort","p1","p2","fetchPosts","RssFeed","PlayCircleFilled","Group","map","p","Online","useFetchData","API","Userbox","theme","setTheme","url","documentElement","classList","add","useMemo","Brightness7","Brightness4","Rightbar","friends","setFriends","circle","setCircle","fetchUsers","fetchCircle","ProfileRightbar","u","ProfileRightbarOption","city","from","relationship","Topbar","history","useHistory","Search","Home","Settings","push","Layout","Image","isInView","setIsInView","Photos","filter","item","useFetchPosts","Timeline","filterPosts","displayPosts","arr","title","dayjs","cardDetailedText","slideShow","items","mode","hideControls","useReadMore","allowDynamicUpdate","scrollable","Filter","props","path","component","home","Profile","useParams","coverPicture","Login","email","password","handleClick","token","login","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","required","minLength","passwordAgain","handlerRegister","Setting","handlerSubmit","newUser","updateUser","Basic","fontSize","initialValues","autoComplete","variant","color","NoFound","protectedRoute","isAuth","Component","rest","render","routeProps","App","Register","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.212d54e2.chunk.js","sourcesContent":["const Storage = {\n  set(key, value) {\n    localStorage.setItem(key, JSON.stringify(value));\n  },\n  get(key) {\n    return JSON.parse(localStorage.getItem(key));\n  },\n  remove(key) {\n    localStorage.removeItem(key);\n  },\n  clear() {\n    localStorage.clear();\n  },\n};\n\nexport default Storage;\n","import axios from \"axios\";\nimport { toast } from \"react-toastify\";\n\nimport Storage from \"./localStorage\";\n\n// url = \"http://localhost:8800/api/\"\nconst http = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || \"/api\",\n  timeout: 20 * 2000,\n});\n\nhttp.interceptors.request.use((config) => {\n  config.headers.Authorization =\n    \"Bearer \" + Storage.get(\"token\") || \"\";\n\n  return config;\n});\n\nhttp.interceptors.response.use(\n  (res) => {\n    return res;\n  },\n  (err) => {\n    console.log(err.response);\n    toast(err.response?.data?.message);\n    return Promise.reject(err);\n  }\n);\n\nexport default http;\n","import { createContext, useState } from \"react\";\n\nimport Storage from \"../serivce/localStorage\";\n\nconst INITIAL_STATE = { user: null };\n\nexport const UserContext = createContext(INITIAL_STATE);\n\nexport const UserContextProvider = ({ children }) => {\n  const [user, setUser] = useState(\n    Storage.get(\"user\") || null\n  );\n\n  // const providerValue = useMemo(\n  //   () => ({ user, setUser }),\n  //   [user, setUser]\n  // );\n  return (\n    <UserContext.Provider value={{ user, setUser }}>\n      {children}\n    </UserContext.Provider>\n  );\n};\n","import React, {\n  useRef,\n  useState,\n  useContext,\n  useEffect,\n} from \"react\";\nimport { PermMedia } from \"@material-ui/icons/\";\n\nimport http from \"../../serivce/API\";\nimport { UserContext } from \"../../context/UserContext\";\n\nexport default function Share({ username }) {\n  const desc = useRef(\"\");\n  const [file, setFile] = useState(null);\n  const { user } = useContext(UserContext);\n  const [hide, setHide] = useState(true);\n\n  const changeVisible = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    setHide(!hide);\n  };\n\n  const format = (text) => {\n    var replaceRegex = /(\\n\\r|\\r\\n|\\r|\\n)/g;\n\n    text = text || \"\";\n\n    return text.replace(replaceRegex, \"<br/>\");\n  };\n\n  const submitHandler = async (e) => {\n    e.preventDefault();\n\n    const newPost = {\n      userId: user._id,\n      desc: format(desc.current.value),\n    };\n\n    if (file) {\n      const data = new FormData();\n      const fileName = Date.now() + file.name;\n      // 这边append 的顺序不对会导致服务器端娶不到 req.body\n      data.append(\"fileName\", fileName);\n      data.append(\"file\", file);\n      try {\n        const { data: imgURL } = await http.post(\n          \"/upload\",\n          data\n        );\n\n        newPost.img = imgURL;\n      } catch (error) {}\n    }\n\n    try {\n      await http.post(\"/posts\", newPost);\n      window.location.reload();\n    } catch (error) {}\n  };\n\n  useEffect(() => {\n    const handler = () => {\n      setHide(true);\n    };\n    document.addEventListener(\"click\", handler);\n\n    const submitHandler = async () => {\n      const newPost = {\n        userId: user._id,\n        desc: format(desc.current.value),\n      };\n\n      if (file) {\n        const data = new FormData();\n        const fileName = Date.now() + file.name;\n        // 这边append 的顺序不对会导致服务器端娶不到 req.body\n        data.append(\"fileName\", fileName);\n        data.append(\"file\", file);\n        newPost.img = fileName;\n        try {\n          await http.post(\"/upload\", data);\n        } catch (error) {}\n      }\n\n      try {\n        await http.post(\"/posts\", newPost);\n        window.location.reload();\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    const keydownHandler = (e) => {\n      if (e.keyCode === 13 && e.ctrlKey) {\n        submitHandler();\n      }\n    };\n\n    document.addEventListener(\"keydown\", keydownHandler);\n\n    return () => {\n      document.removeEventListener(\n        \"keydown\",\n        keydownHandler\n      );\n      document.removeEventListener(\"click\", handler);\n    };\n  }, [file, user]);\n\n  const ShareComponent = () => (\n    <div className='w-full p-4 bg-white shadow-lg rounded-md  dark:bg-gray-800 dark:text-gray-200'>\n      <div className=''>\n        <img src='' alt='' />\n        <textarea\n          type='text'\n          placeholder='有什么有趣的事情分享给大家?'\n          className='w-full resize-none outline-none dark:bg-gray-800 dark:text-gray-200'\n          ref={desc}\n        />\n      </div>\n      <hr className='my-4' />\n      {file && (\n        <div className='flex justify-center items-center'>\n          <img\n            alt=''\n            className='rounded-sm max-h-96 shadow-lg'\n            src={URL.createObjectURL(file)}\n          ></img>\n        </div>\n      )}\n      <form\n        className='flex justify-between'\n        onSubmit={submitHandler}\n      >\n        <div className=''>\n          <label htmlFor='file' className=''>\n            <PermMedia htmlColor='tomato' className='' />\n\n            <input\n              type='file'\n              id='file'\n              style={{ display: \"none\" }}\n              accept='.png,.jpeg,.jpg'\n              onChange={(e) => setFile(e.target.files[0])}\n            />\n          </label>\n        </div>\n\n        <button className='' type='submit'>\n          发送\n        </button>\n      </form>\n    </div>\n  );\n\n  // 条件渲染Share 组件\n  if (username === undefined) {\n    return <ShareComponent />;\n  } else if (username === user?.username) {\n    return <ShareComponent />;\n  } else {\n    return null;\n  }\n}\n","import { useEffect } from \"react\";\n\nlet listenerCallbacks = new WeakMap();\n\nlet observer;\n\nfunction handleIntersections(entries) {\n  entries.forEach((entry) => {\n    const target = entry.target;\n    if (listenerCallbacks.has(target)) {\n      let cb = listenerCallbacks.get(target);\n\n      if (entry.isIntersecting || entry.intersectionRatio > 0) {\n        target.src = target.dataset[\"src\"] ?? \"\";\n        observer.unobserve(target);\n        listenerCallbacks.delete(target);\n        cb();\n      }\n    }\n  });\n}\n\nfunction getIntersectionObserver() {\n  if (observer === undefined) {\n    observer = new IntersectionObserver(handleIntersections, {\n      rootMargin: \"100px\",\n      threshold: \"0.15\",\n    });\n  }\n  return observer;\n}\n\nexport function useIntersection(elem, callback) {\n  useEffect(() => {\n    let target = elem.current;\n    let observer = getIntersectionObserver();\n    listenerCallbacks.set(target, callback);\n    observer.observe(target);\n\n    return () => {\n      listenerCallbacks.delete(target);\n      observer.unobserve(target);\n    };\n  }, []);\n}\n","import { MoreVert } from \"@material-ui/icons\";\nimport React, { useEffect, useContext, useRef } from \"react\";\nimport { useState } from \"react\";\nimport http from \"../../serivce/API\";\nimport { Link } from \"react-router-dom\";\nimport { format } from \"timeago.js\";\nimport { UserContext } from \"../../context/UserContext\";\nimport { useIntersection } from \"../../hooks/useIntersectionObserver\";\nexport default function Post({ post }) {\n  // console.log(post);\n  const [like, setLike] = useState(post.likes.length);\n  const [isLiked, setIsLiked] = useState(false);\n  const [visible, setVisible] = useState(false);\n  const imgRef = useRef();\n\n  useIntersection(imgRef, () => {});\n\n  const [user, setUser] = useState({});\n\n  const { user: currentUser } = useContext(UserContext);\n\n  useEffect(() => {\n    const handler = () => {\n      setVisible(false);\n    };\n    document.addEventListener(\"click\", handler);\n    const fetchUser = async () => {\n      const res = await http.get(`/users/?userId=${post.userId}`);\n      setUser(res.data);\n    };\n    fetchUser();\n    return () => {\n      document.removeEventListener(\"click\", handler);\n    };\n  }, [post.userId, setVisible, visible]);\n\n  const likeHandler = () => {\n    setLike(isLiked ? like - 1 : like + 1);\n    setIsLiked(!isLiked);\n  };\n\n  const handlerClick = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    setVisible(!visible);\n  };\n  const handlerDelete = () => {\n    const deletePost = async () => {\n      if (post.userId === currentUser._id) {\n        await http.delete(\"posts/\" + post._id, {\n          data: {\n            userId: currentUser._id,\n          },\n        });\n      } else {\n        alert(\"你不能删除别人的博客\");\n      }\n    };\n    deletePost();\n    window.location.reload();\n  };\n\n  const handlerFollow = () => {\n    const followUser = async () => {\n      if (currentUser?._id !== post.userId) {\n        await http.put(`users/${post.userId}/follow`, {\n          userId: currentUser?._id,\n        });\n        alert(\"关注成功\");\n      } else {\n        alert(\"你不能关注自己\");\n      }\n    };\n    followUser();\n  };\n\n  const handlerUnfolllow = () => {\n    const unFollowUser = async () => {\n      if (currentUser._id !== post.userId) {\n        await http.put(`users/${post.userId}/unfollow`, {\n          userId: currentUser._id,\n        });\n        alert(\"取消关注成功\");\n        window.location.reload();\n      } else {\n        alert(\"你不能取消关注自己\");\n      }\n    };\n    unFollowUser();\n  };\n  return (\n    <div className=\"flex flex-col relative\">\n      <div\n        className={`${\n          visible ? \"inline-flex\" : \"hidden\"\n        } flex-col  bg-white text-gray-600  w-40 text-center rounded-md space-y-2 cursor-pointer absolute top-20 right-0 z-20 shadow-2xl overflow-hidden dark:bg-gray-800 dark:text-gray-200`}\n      >\n        <span\n          className=\"hover:bg-pink-400 hover:text-white p-2\"\n          onClick={handlerFollow}\n        >\n          关注\n        </span>\n        <span\n          className=\"hover:bg-pink-400 hover:text-white p-2\"\n          onClick={handlerUnfolllow}\n        >\n          取消关注\n        </span>\n        <span\n          className=\"hover:bg-pink-400 hover:text-white p-2\"\n          onClick={handlerDelete}\n        >\n          删除\n        </span>\n        <span\n          className=\"hover:bg-pink-400 hover:text-white p-2\"\n          onClick={handlerDelete}\n        >\n          加入特别关注\n        </span>\n      </div>\n\n      <div className=\"flex flex-col bg-white rounded-md shadow-lg text-gray-600 p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200\">\n        <div className=\"flex justify-between items-center\">\n          <div className=\"flex items-center space-x-4\">\n            <Link to={`/profile/${user.username}`}>\n              <img\n                className=\"w-102 h-10 object-cover rounded-full\"\n                src={\n                  user.profilePicture ||\n                  \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png\"\n                }\n                alt=\"\"\n              />\n            </Link>\n            <span className=\"\">{user.username}</span>\n            <span className=\"\">{format(post.createdAt, \"zh_CN\")}</span>\n          </div>\n\n          <div className=\"\">\n            <MoreVert onClick={handlerClick} className=\"cursor-pointer\" />\n          </div>\n        </div>\n        <div className=\"flex flex-col space-y-4\">\n          <span\n            className=\"\"\n            dangerouslySetInnerHTML={{ __html: post.desc }}\n          ></span>\n          <img\n            src={null}\n            alt=\"\"\n            className=\"rounded-sm\"\n            data-src={post.img}\n            ref={imgRef}\n          />\n        </div>\n        {/* <div className='flex items-center justify-evenly'>\n          <div className='flex  items-center cursor-pointer'>\n            <span>\n              <ThumbUpAlt />\n            </span>\n\n            <span className='pl-1'>{like}</span>\n          </div>\n          <div className=''>\n            <span className=''>{post.comment} 评论</span>\n          </div>\n        </div> */}\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from \"react\";\nimport http from \"../../serivce/API\";\n\nimport { useContext } from \"react\";\nimport {\n  RssFeed,\n  PlayCircleFilled,\n  Group,\n} from \"@material-ui/icons\";\n\nimport { Link } from \"react-router-dom\";\nimport { UserContext } from \"../../context/UserContext\";\n\nimport Share from \"../share/Share\";\nimport Post from \"../post/Post\";\nimport { useLocation } from \"react-router-dom\";\n\nexport default function Feed({ username }) {\n  const [posts, setPosts] = useState([]);\n  const { user } = useContext(UserContext);\n\n  const params = useLocation();\n  const SearchKey = params.search.split(\"=\").pop();\n\n\n  // 需要解决的问题，等我的页面加载到再渲染。\n  useEffect(() => {\n    const fetchPosts = async () => {\n      if (SearchKey) {\n        const res = await http.get(\n          `posts/friends/${SearchKey}`\n        );\n        setPosts(\n          res.data?.flat().sort((p1, p2) => {\n            return (\n              new Date(p2.createdAt) -\n              new Date(p1.createdAt)\n            );\n          })\n        );\n      } else {\n        const res = username\n          ? await http.get(\"posts/profile/\" + username)\n          : await http.get(`posts/timeline/now`);\n\n        setPosts(\n          res.data?.sort((p1, p2) => {\n            return (\n              new Date(p2.createdAt) -\n              new Date(p1.createdAt)\n            );\n          })\n        );\n      }\n    };\n    fetchPosts();\n  }, [username, SearchKey]);\n\n  return (\n    <div className='w-full'>\n      {!username && (\n        <div className='hidden lg:block w-56 bg-white text-gray-600 rounded-md p-4 space-y-4 shadow-lg fixed dark:bg-gray-800 dark:text-gray-200 '>\n          <h3 className=''>首页</h3>\n          <div className='flex flex-col space-y-4'>\n            <Link to='/home/share'>\n              <RssFeed />\n              <span className='pl-4'>全部关注</span>\n            </Link>\n\n            <Link to='/'>\n              <PlayCircleFilled />\n              <span className='pl-4'>特别关注</span>\n            </Link>\n\n            <Link to={`?userId=${user?._id}`}>\n              <Group />\n              <span className='pl-4'>好友圈</span>\n            </Link>\n          </div>\n        </div>\n      )}\n\n      <div className='w-full  lg:w-9/12  ml-auto space-y-8 '>\n        <Share username={username} />\n        {posts.map((p) => {\n          return <Post key={p._id} post={p}></Post>;\n        })}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\n\nimport { Link } from \"react-router-dom\";\nexport default function Online({ user }) {\n  return (\n    <Link to={`/profile/${user.username}`}>\n      <li className='text-gray-600 flex items-center justify-between dark:text-gray-200'>\n        <div className=''>\n          <img\n            src={\n              user.profilePicture\n                ? user.profilePicture\n                : \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png\"\n            }\n            alt=''\n            className='w-12 h-12 object-cover rounded-full'\n          />\n          <span className=''></span>\n        </div>\n        <span className=''>{user.username}</span>\n      </li>\n    </Link>\n  );\n}\n","import { useEffect, useState } from \"react\";\r\nimport API from \"../serivce/API\";\r\nexport const useFetchData = (URL) => {\r\n  const [user, setUser] = useState({});\r\n\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await API.get(URL);\r\n      setUser(res.data);\r\n    };\r\n    fetchUser();\r\n  }, [URL]);\r\n  return [user];\r\n};\r\n","import React, {\n  useContext,\n  useMemo,\n  useState,\n  useEffect,\n} from \"react\";\nimport {\n  Brightness4,\n  Brightness7,\n} from \"@material-ui/icons\";\n\nimport { UserContext } from \"../../context/UserContext\";\n\nimport { Link } from \"react-router-dom\";\nimport { useFetchData } from \"../../hooks/useFetchData\";\nimport Storage from \"../../serivce/localStorage\";\n\nexport default function Userbox() {\n  const [theme, setTheme] = useState(false);\n  const { user: currentUser } = useContext(UserContext);\n\n  const url = `users/${currentUser?._id}`;\n  const [user] = useFetchData(url);\n  useEffect(() => {\n    if (Storage.get(\"theme\")) {\n      document.documentElement.classList.remove(\"dark\");\n    } else {\n      document.documentElement.classList.add(\"dark\");\n    }\n  });\n  return useMemo(() => {\n    const handlerClickLight = () => {\n      setTheme(false);\n      Storage.set(\"theme\", theme);\n      document.documentElement.classList.add(\"dark\");\n    };\n    const handlerClickDark = () => {\n      setTheme(true);\n      Storage.set(\"theme\", theme);\n      document.documentElement.classList.remove(\"dark\");\n    };\n\n    return (\n      <div className='bg-white p-4 text-gray-600 flex flex-col space-y-6 shadow-lg rounded-md dark:bg-gray-800 dark:text-gray-200'>\n        <div className='flex justify-between items-center'>\n          <Link\n            to={user ? `/profile/${user.username}` : \"/\"}\n          >\n            <img\n              src={\n                user?.profilePicture ||\n                \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png\"\n              }\n              className='w-16 h-16 object-cover rounded-md'\n              alt='avatart'\n            />\n          </Link>\n\n          <div>{user?.username}</div>\n          {theme ? (\n            <span\n              className='cursor-pointer'\n              onClick={handlerClickLight}\n            >\n              <Brightness7 />\n            </span>\n          ) : (\n            <span\n              className='cursor-pointer'\n              onClick={handlerClickDark}\n            >\n              <Brightness4 />\n            </span>\n          )}\n        </div>\n        <Link\n          to='/home'\n          className='text-center hover:text-pink-400'\n        >\n          分享一刻\n        </Link>\n        <Link\n          to='/home/photos'\n          className='text-center  hover:text-pink-400'\n        >\n          照片流\n        </Link>\n        <Link\n          to='/home/timeline'\n          className='text-center hover:text-pink-400'\n        >\n          时刻岛\n        </Link>\n      </div>\n    );\n  }, [user, theme]);\n}\n","import { useContext, useState, useEffect } from \"react\";\nimport Online from \"../online/Online\";\nimport { UserContext } from \"../../context/UserContext\";\nimport http from \"../../serivce/API\";\nimport { Link } from \"react-router-dom\";\nimport Userbox from \"../userbox/Userbox\";\nexport default function Rightbar({ user }) {\n  const [friends, setFriends] = useState([]);\n  const { user: currentUser } = useContext(UserContext);\n  const [circle, setCircle] = useState([]);\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      const res = await http.get(\n        `users/friends/${currentUser?._id}`\n      );\n\n      setFriends(res?.data);\n    };\n    fetchUsers();\n  }, [currentUser]);\n\n  useEffect(() => {\n    const fetchCircle = async () => {\n      const res = await http.get(\n        `users/circle/${currentUser?._id}`\n      );\n      setCircle(res?.data);\n    };\n    fetchCircle();\n  }, [currentUser]);\n\n  const ProfileRightbar = () => {\n    return (\n      <div className='flex flex-col space-y-6 ml-4'>\n        {/* BUG */}\n        <Userbox />\n        <div className='bg-white p-4 text-gray-600 flex flex-col space-y-4 shadow-lg rounded-md dark:bg-gray-800 dark:text-gray-100'>\n          <h4 className=''>我的关注</h4>\n          <ul className='flex flex-col space-y-4'>\n            {friends &&\n              friends.map((u) => (\n                <Online key={u?._id} user={u} />\n              ))}\n          </ul>\n        </div>\n      </div>\n    );\n  };\n\n  const ProfileRightbarOption = () => {\n    return (\n      <>\n        <div className='rounded-md shadow-xl p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200'>\n          <div>简介</div>\n          <div className=''>\n            <div className=''>\n              <span className=''>居住地:</span>\n              <span className=''>{user.city}</span>\n            </div>\n            <div className=''>\n              <span className=''>家乡:</span>\n              <span className=''>{user.from}</span>\n            </div>\n            <div className=''>\n              <span className=''>职业:</span>\n              <span className=''>{user.relationship}</span>\n            </div>\n          </div>\n        </div>\n\n        <div className='rounded-md shadow-xl p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200'>\n          <h4 className=''>好友圈</h4>\n          {circle &&\n            circle.map((u) => {\n              return (\n                <Link\n                  to={`/profile/${u.username}`}\n                  key={u?._id}\n                  className='block'\n                >\n                  <div className='flex items-center justify-between'>\n                    <img\n                      src={\n                        u.profilePicture\n                          ? u.profilePicture\n                          : \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png\"\n                      }\n                      alt=''\n                      className='w-16 h-16 object-cover rounded-full'\n                    />\n                    <span className=''>{u?.username}</span>\n                  </div>\n                </Link>\n              );\n            })}\n        </div>\n      </>\n    );\n  };\n  return (\n    <>\n      {user ? (\n        <ProfileRightbarOption />\n      ) : (\n        <ProfileRightbar />\n      )}\n    </>\n  );\n}\n","// import \"./topbar.css\";\nimport { Search, Settings, Home } from \"@material-ui/icons\";\nimport React, { useContext } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { UserContext } from \"../../context/UserContext\";\nimport Storage from \"../../serivce/localStorage\";\nimport { useFetchData } from \"../../hooks/useFetchData\";\n\nexport default function Topbar() {\n  const { user: currentUser } = useContext(UserContext);\n  const history = useHistory();\n\n  const url = currentUser ? `users/${currentUser._id}` : \"\";\n  const [user] = useFetchData(url);\n\n  const handlerLogout = () => {\n    history.push(\"/login\");\n    Storage.clear();\n  };\n  return (\n    <div className='h-12 mx-auto max-w-7xl w-full bg-white flex items-center text-gray-700 dark:bg-gray-800 dark:text-white '>\n      <div className='w-3/12'>\n        <Link to='/home'>\n          <span className='text-2xl  ml-6 cursor-pointer font-bold'>\n            Fujix\n          </span>\n        </Link>\n      </div>\n      <div className='w-5/12'>\n        <div className='w-full  flex items-center rounded-full h-8 bg-gray-100'>\n          <Search className='ml-2' />\n          <input\n            type='text'\n            placeholder=''\n            className='outline-none pl-2 w-3/5 bg-gray-100'\n          />\n        </div>\n      </div>\n      <div className='w-4/12 flex items-center justify-evenly '>\n        <Link to={user ? `/profile/${user.username}` : \"/\"}>\n          <img\n            src={\n              user.profilePicture ||\n              \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png\"\n            }\n            className='rounded-full text-lg object-cover h-8 w-8'\n            alt='avatart'\n          />\n        </Link>\n        <Link to='/home'>\n          <span>\n            <Home />\n          </span>\n        </Link>\n        <Link to='/setting'>\n          <span>\n            <Settings />\n          </span>\n        </Link>\n        <span\n          onClick={handlerLogout}\n          className='cursor-pointer'\n        >\n          登出\n        </span>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport Topbar from \"../../components/topbar/Topbar\";\n\nexport default function Layout({ children }) {\n  return (\n    <div className='scoll-min dark:bg-gray-600'>\n      <div className='sticky top-0 z-50 bg-white shadow-md dark:bg-gray-800'>\n        <Topbar />\n      </div>\n      <div className='mx-auto max-w-7xl my-10 dark:bg-gray-600'>\n        <div className='flex'>{children}</div>\n      </div>\n    </div>\n  );\n}\n","import React, { useRef, useState } from \"react\";\nimport { useIntersection } from \"../../../hooks/useIntersectionObserver\";\n\nexport default function Image({ post }) {\n  const [isInView, setIsInView] = useState(false);\n  const ref = useRef();\n  useIntersection(ref, () => {\n    setIsInView(true);\n  });\n  return (\n    <img\n      alt=\"\"\n      src={null}\n      data-src={post.img}\n      ref={ref}\n      className={`w-1/3 max-h-80 object-cover opacity-95 p-2 scale-100 cursor-pointer transform  transition duration-500 ease-in-out  hover:opacity-100  hover:scale-105 ${\n        isInView ? \"\" : \"filter blur\"\n      }`}\n    ></img>\n  );\n}\n","import { useContext } from \"react\";\nimport React from \"react\";\nimport { UserContext } from \"../../../context/UserContext\";\nimport { useFetchPosts } from \"../../../hooks/useFetchPostsPhoto\";\nimport Image from \"./Image\";\nexport default function Photos() {\n  const { user } = useContext(UserContext);\n\n  let url = `posts/portfolio/${user?._id}`;\n  const posts = useFetchPosts(url);\n  return (\n    <div className=\"flex flex-wrap  bg-white p-4 rounded-md mb-10 dark:bg-gray-800\">\n      {posts.map((post) => {\n        return <Image post={post} key={post._id}></Image>;\n      })}\n    </div>\n  );\n}\n","import { useState, useEffect } from \"react\";\nimport http from \"../serivce/API\";\n\nexport const useFetchPosts = (url) => {\n  const [posts, setPosts] = useState([]);\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      try {\n        const res = await http.get(url);\n\n        let filter = res.data?.sort((p1, p2) => {\n          return (\n            new Date(p2.createdAt) - new Date(p1.createdAt)\n          );\n        });\n        setPosts(\n          filter.filter((item) => item.img !== undefined)\n        );\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    fetchPosts();\n  }, [url]);\n\n  return posts;\n};\n","import React, {\n  useState,\n  useEffect,\n  useContext,\n} from \"react\";\nimport http from \"../../serivce/API\";\nimport dayjs from \"dayjs\";\nimport { UserContext } from \"../../context/UserContext\";\nimport { Chrono } from \"react-chrono\";\nexport default function Timeline() {\n  const [posts, setPosts] = useState([]);\n  const { user } = useContext(UserContext);\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      const res = await http.get(\n        `posts/profile/${user.username}`\n      );\n\n      const filterPosts = res.data?.sort((p1, p2) => {\n        return (\n          new Date(p2.createdAt) - new Date(p1.createdAt)\n        );\n      });\n      let displayPosts = [];\n\n      filterPosts.forEach((item) => {\n        if (item.desc !== \"\") {\n          let arr = {};\n          arr.title = dayjs(item.createdAt).format(\n            \"DD/MM/YYYY\"\n          );\n          arr.cardDetailedText = item.desc;\n          displayPosts.push(arr);\n        }\n      });\n\n\n      setPosts(displayPosts);\n    };\n\n    fetchPosts();\n  }, [user]);\n\n  return (\n    <div className='dark:bg-gray-800 dark:text-gray-200  p-4 pb-24 mb-20 overflow-hidden rounded-md shadow-lg bg-white'>\n      <div className='text-center my-4'>\n        <div></div>\n        {posts && (\n          <Chrono\n            slideShow\n            items={posts}\n            mode='VERTICAL_ALTERNATING'\n            hideControls\n            useReadMore={false}\n            allowDynamicUpdate={true}\n            scrollable={true}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\r\n\r\nexport default function Filter() {\r\n  return (\r\n    <div>\r\n      <h1>Filter</h1>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport Feed from \"../../components/feed/Feed\";\nimport Rightbar from \"../../components/rightbar/Rightbar\";\n\nimport Layout from \"../../components/layout/Layout\";\nimport { Route, Switch } from \"react-router-dom\";\nimport Photos from \"./photos/index\";\nimport Timeline from \"../../components/timeline/index.jsx\";\nimport Filter from \"../../components/filter/index.jsx\";\nexport default function Home(props) {\n  return (\n    <Layout>\n      <div className='w-full sm:w-9/12 m-4 sm:m-0'>\n        <Switch>\n          <Route path='/home/photos' component={Photos} />\n          <Route\n            path='/home/timeline'\n            component={Timeline}\n          />\n          <Route path='/home/filter' component={Filter} />\n          <Route path='/home' component={Feed} />\n        </Switch>\n      </div>\n      <div className='hidden sm:block sm:w-3/12'>\n        <Rightbar home={true} />\n      </div>\n    </Layout>\n  );\n}\n","import { useState, useEffect } from \"react\";\nimport Feed from \"../../components/feed/Feed\";\nimport Rightbar from \"../../components/rightbar/Rightbar\";\nimport http from \"../../serivce/API\";\n\nimport { useParams } from \"react-router\";\nimport Layout from \"../../components/layout/Layout\";\n\nexport default function Profile() {\n  const [user, setUser] = useState({});\n  const { username } = useParams();\n  useEffect(() => {\n    let fetchUser = async () => {\n      const res = await http.get(\n        `/users?username=${username}`\n      );\n      setUser(res.data);\n    };\n    fetchUser();\n    return () => {\n      fetchUser = null;\n    };\n  }, [username]);\n\n  return (\n    <Layout>\n      <div className='bg-white rounded-sm shadow-lg w-full dark:bg-gray-600 overflow-hidden'>\n        {/* <Sidebar /> */}\n\n        <div className=''>\n          <div className='relative'>\n            <img\n              src={\n                user.coverPicture ||\n                \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png\"\n              }\n              alt=''\n              className='w-full h-52 object-cover'\n            />\n            <img\n              src={\n                user.profilePicture ||\n                \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png\"\n              }\n              alt=''\n              className='w-32 h-32 object-cover rounded-full absolute top-full left-1/2 transform -translate-x-1/2 -translate-y-1/2'\n            />\n          </div>\n          <div className='mt-20 text-center dark:text-gray-200'>\n            <div className=''>{user.username}</div>\n            <div className=''>{user.desc}</div>\n            <button className='bg-white rounded-md shadow-lg p-4 text-center my-4 dark:bg-gray-800 dark:text-gray-200 '>已关注</button>\n          </div>\n        </div>\n        <div className='flex text-gray-600 p-4'>\n          <div className='w-9/12'>\n            <Feed username={username} />\n          </div>\n          <div className='w-3/12 ml-4 space-y-8'>\n            <Rightbar user={user} />\n          </div>\n        </div>\n      </div>\n    </Layout>\n  );\n}\n","import React, { useContext, useEffect } from \"react\";\nimport { useRef } from \"react\";\nimport { UserContext } from \"../../context/UserContext\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\nimport { useHistory } from \"react-router-dom\";\n// import \"./login.css\";\nimport API from \"../../serivce/API\";\n\nimport { ToastContainer } from \"react-toastify\";\nimport Storage from \"../../serivce/localStorage\";\n\nexport default function Login() {\n  const { setUser } = useContext(UserContext);\n  const email = useRef();\n  const password = useRef();\n  const history = useHistory();\n\n  const handleClick = (e) => {\n    e?.preventDefault();\n\n    const login = async () => {\n      const { data } = await API.post(\"auth/login\", {\n        email: email.current.value,\n        password: password.current.value,\n      });\n      // toast.success(\"🦄 登陆成功\");\n      Storage.set(\"token\", data.token);\n      Storage.set(\"user\", data.user);\n      setUser(data.user);\n      history.push(\"/home/share\");\n    };\n\n    login();\n  };\n\n  useEffect(() => {\n    const keydownHandler = (e) => {\n      if (e.keyCode === 13) {\n        handleClick();\n      }\n    };\n    document.addEventListener(\"keydown\", keydownHandler);\n    return () => {\n      document.removeEventListener(\n        \"keydown\",\n        keydownHandler\n      );\n    };\n  });\n\n  const handlerCreate = () => {\n    history.push(\"/register\");\n  };\n  return (\n    <div className='mx-auto bg-gradient-to-r from-purple-400 via-pink-500  text-white flex flex-col justify-center space-y-6 h-screen'>\n      <ToastContainer\n        position='top-center'\n        autoClose={2500}\n        hideProgressBar={false}\n        newestOnTop={false}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n      />\n      <div className='flex flex-col h-screen justify-center items-center space-y-10'>\n        <div className='w-full  md:w-1/2 flex justify-center items-center flex-col space-y-4 '>\n          <h2 className='text-6xl font-bold'>Fujix</h2>\n          <span>用照片分享你的生活</span>\n        </div>\n        <div className='w-full md:w-2/3  lg:w-1/2  flex justify-center items-center '>\n          <form\n            onSubmit={handleClick}\n            className='w-full m-4  md:w-1/2 flex bg-white p-4 flex-col justify-center items-center space-y-4  rounded-md shadow-xl '\n          >\n            <input\n              placeholder='邮箱'\n              type='email'\n              required\n              ref={email}\n              value='shaodeyu@gmail.com'\n              className='w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n            />\n            <input\n              placeholder='请输入密码'\n              type='password'\n              required\n              minLength='6'\n              value={123456}\n              className='w-full shadow-lg  p-2 rounded-md outline-none border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n              ref={password}\n            />\n            <button className='w-full shadow-lg bg-blue-400 p-2   rounded-md text-white my-8'>\n              登陆\n            </button>\n            <span className='text-gray-400 text-sm'>\n              忘记密码？\n            </span>\n            <button\n              onClick={handlerCreate}\n              className='w-full  shadow-lg bg-pink-400  p-2 text-white rounded-md'\n            >\n              创建新账号\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useRef } from \"react\";\nimport http from \"../../serivce/API\";\nimport { useHistory } from \"react-router\";\nexport default function Login() {\n  const password = useRef();\n  const username = useRef();\n  const passwordAgain = useRef();\n  const email = useRef();\n  const history = useHistory();\n\n  const handlerClick = (e) => {\n    e.preventDefault();\n    if (\n      password.current.value === passwordAgain.current.value\n    ) {\n      const handlerRegister = async () => {\n        try {\n          await http.post(\"auth/register\", {\n            username: username.current.value,\n            password: password.current.value,\n            email: email.current.value,\n          });\n        } catch (error) {\n          console.log(error);\n        }\n      };\n      handlerRegister();\n      history.push(\"/login\");\n    } else {\n      alert(\"两次输入密码不同\");\n    }\n  };\n\n  const handlerLogin = () => {\n    history.push(\"/login\");\n  };\n  return (\n    <div className='mx-auto bg-gradient-to-r from-purple-400 via-pink-500 text-white flex flex-col justify-center space-y-6 h-screen'>\n      <div className='flex flex-col h-screen justify-center items-center space-y-10'>\n        <div className='w-full  md:w-1/2 flex justify-center items-center flex-col space-y-4 '>\n          <h2 className='text-6xl font-bold'>Fujix</h2>\n          <span>用照片分享你的生活</span>\n        </div>\n        <div className='w-full md:w-2/3  lg:w-1/2  flex justify-center items-center '>\n          <form\n            onSubmit={handlerClick}\n            className='w-full m-4  md:w-1/2 flex bg-white p-4 flex-col justify-center items-center space-y-4  rounded-md shadow-xl '\n          >\n            <input\n              placeholder='用户名'\n              ref={username}\n              required\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600'\n            />\n            <input\n              placeholder='邮箱'\n              ref={email}\n              required\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600'\n              type='email'\n            />\n            <input\n              placeholder='密码'\n              ref={password}\n              type='password'\n              minLength='6'\n              required\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600'\n            />\n            <input\n              placeholder='再次确认密码'\n              ref={passwordAgain}\n              type='password'\n              required\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600'\n            />\n            <button\n              type='submit'\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400  bg-blue-400 p-2   rounded-md text-white my-8'\n            >\n              注册\n            </button>\n\n            <button\n              onClick={handlerLogin}\n              className='w-full shadow-lg focus:ring-2 focus:ring-blue-400 bg-pink-400  p-2 text-white rounded-md'\n            >\n              登陆\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, {\n  useContext,\n  useState,\n  useEffect,\n} from \"react\";\nimport { Formik, Field, Form } from \"formik\";\n\nimport Layout from \"../../components/layout/Layout\";\nimport { UserContext } from \"../../context/UserContext\";\nimport http from \"../../serivce/API\";\nimport { Settings } from \"@material-ui/icons\";\nexport default function Setting() {\n  const { user: currentUser } = useContext(UserContext);\n  const [file, setFile] = useState(null);\n  const [user, setUser] = useState({});\n  const { username, city, from, desc } = user;\n  useEffect(() => {\n    const fetchUser = async () => {\n      const res = await http.get(\n        `users/${currentUser._id}`\n      );\n      setUser(res.data);\n    };\n    fetchUser();\n  }, [currentUser, setUser]);\n  const handlerSubmit = (value) => {\n    //更新完了。怎么重新获取用户数据？\n\n    const newUser = {\n      userId: currentUser?._id,\n      ...value,\n    };\n\n    const updateUser = async () => {\n      try {\n        if (file) {\n          const data = new FormData();\n          const fileName = Date.now() + file.name;\n\n          data.append(\"fileName\", fileName);\n          data.append(\"file\", file);\n          const { data: imgURL } = await http.post(\n            \"/upload\",\n            data\n          );\n          newUser.profilePicture = imgURL;\n        }\n\n        // 更新数据\n        await http.put(`users/${currentUser._id}`, newUser);\n        alert(\"保存成功\");\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    updateUser();\n  };\n\n  const Basic = () => (\n    <div className='mx-auto w-full bg-white text-gray-400  shadow-lg flex flex-col justify-center space-y-6 px-80 mb-10 py-20 dark:bg-gray-800 dark:text-gray-200 rounded-md'>\n      <div className='space-y-4'>\n        <h2 className='mb-4 flex items-center'>\n          <Settings fontSize='large'></Settings>\n          <span className='font-bold pl-4 text-2xl'>\n            设置\n          </span>\n        </h2>\n        <label htmlFor='file'>\n          {file ? (\n            <img\n              alt=''\n              className=''\n              src={URL.createObjectURL(file)}\n            />\n          ) : (\n            <img\n              src={\n                user.profilePicture ||\n                \"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png\"\n              }\n              alt=''\n              className='w-32 h-32 rounded-lg object-cover shadow-lg'\n            />\n          )}\n\n          <input\n            type='file'\n            id='file'\n            style={{ display: \"none\" }}\n            accept='.png,.jpeg,.jpg'\n            onChange={(e) => setFile(e.target.files[0])}\n          />\n        </label>\n        <Formik\n          initialValues={{ username, city, from, desc }}\n          onSubmit={handlerSubmit}\n        >\n          <Form className='flex flex-col space-y-4'>\n            <label htmlFor='username'>用户名字</label>\n            <Field\n              id='username'\n              name='username'\n              autoComplete='off'\n              className='w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n            />\n\n            <label htmlFor='desc'>简介</label>\n            <Field\n              id='desc'\n              name='desc'\n              autoComplete='off'\n              className='w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n            />\n            <label htmlFor='city'>城市</label>\n            <Field\n              id='city'\n              name='city'\n              autoComplete='off'\n              className='w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n            />\n\n            <label htmlFor='from'>家乡</label>\n            <Field\n              id='from'\n              name='from'\n              autoComplete='off'\n              className='w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400'\n            />\n            <p></p>\n            <button\n              variant='contained'\n              color='primary'\n              type='submit'\n              className='w-full shadow-lg bg-pink-400  mt-8 p-2 text-white rounded-md dark:bg-blue-400'\n            >\n              保存设置\n            </button>\n          </Form>\n        </Formik>\n      </div>\n    </div>\n  );\n  return (\n    <Layout>\n      <Basic />\n    </Layout>\n  );\n}\n","import React from \"react\";\n\nexport default function NoFound() {\n  return (\n    <div>\n      <h1>404</h1>\n    </div>\n  );\n}\n","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\n\r\nexport default function protectedRoute({\r\n  isAuth,\r\n  component: Component,\r\n  ...rest\r\n}) {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(routeProps) => {\r\n        if (isAuth) {\r\n          return <Component {...routeProps} />;\r\n        } else {\r\n          return <Redirect to='/login' />;\r\n        }\r\n      }}\r\n    ></Route>\r\n  );\r\n}\r\n","import Home from \"./pages/home/Home\";\nimport Profile from \"./pages/profile/Profile\";\nimport Login from \"./pages/login/Login\";\nimport Register from \"./pages/register/Register\";\nimport Setting from \"./pages/setting/Setting\";\n\nimport NoFound from \"./pages/404/NoFound\";\nimport { useContext } from \"react\";\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\";\n\nimport { UserContext } from \"./context/UserContext\";\nimport ProtectedRoute from \"./components/protectedroute\";\n\nfunction App() {\n  const { user } = useContext(UserContext);\n  return (\n    <Router>\n      <Switch>\n        <ProtectedRoute\n          path='/home/'\n          component={Home}\n          isAuth={user}\n        ></ProtectedRoute>\n\n        <Route path='/login' component={Login}></Route>\n\n        <ProtectedRoute\n          path='/register'\n          component={Register}\n          isAuth={user}\n        ></ProtectedRoute>\n        <Route\n          path='/profile/:username'\n          component={Profile}\n        ></Route>\n        <ProtectedRoute\n          path='/setting'\n          component={Setting}\n          isAuth={user}\n        ></ProtectedRoute>\n        <Redirect path='/' to='/home/' />\n        <Route path='*' component={NoFound}></Route>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { UserContextProvider } from \"./context/UserContext\";\nimport \"./styles.css\";\nimport \"./index.css\";\nReactDOM.render(\n  <UserContextProvider>\n    <App />\n  </UserContextProvider>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}