(this["webpackJsonpreact-sm"]=this["webpackJsonpreact-sm"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){},102:function(e,t,c){},103:function(e,t,c){},104:function(e,t,c){},105:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(28),r=c.n(n),a=(c(66),c(119)),i=c(120),o=c(121),l=c(8),u=c(5),j={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},remove:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()}},d=function(e,t){switch(t.type){case"LOGIN_START":var c={user:null,isFetching:!0,error:!1};return j.set("authData",c),c;case"LOGIN_SUCCESS":var s={user:t.payload,isFetching:!1,error:!1};return j.set("authData",s),s;case"UPDATE_USER":var n={user:t.payload,isFetching:!1,error:!1};return j.set("authData",n),n;case"LOGIN_FAILURE":var r={user:null,isFetching:!1,error:t.error};return j.set("authData",r),r;default:return e}},b=c(1),O=j.get("authData")?j.get("authData"):{user:null,isFecthing:!1,error:!1},p=Object(s.createContext)(O),m=function(e){var t=e.children,c=Object(s.useReducer)(d,O),n=Object(u.a)(c,2),r=n[0],a=n[1];return Object(b.jsx)(p.Provider,{value:{user:r.user,isFetching:r.isFetching,error:r.error,dispatch:a},children:t})};function f(){var e=Object(s.useContext)(p).user;return Object(b.jsxs)("div",{className:"sidebar",children:[Object(b.jsx)("h3",{className:"home",children:"\u9996\u9875"}),Object(b.jsx)("div",{className:"sidebarWrapper",children:Object(b.jsxs)("ul",{className:"sidebarList",children:[Object(b.jsx)(l.b,{to:"/",children:Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(a.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u5168\u90e8\u5173\u6ce8"})]})}),Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(i.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u7279\u522b\u5173\u6ce8"})]}),Object(b.jsx)(l.b,{to:"?userId=".concat(null===e||void 0===e?void 0:e._id),children:Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(o.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u597d\u53cb\u5708"})]})})]})})]})}var h=c(3),x=c.n(h),v=c(4),g=c(54),N=c.n(g),_=function(){return N.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"/api"})},S=(c(91),c(122));c(92);function E(e){var t=e.username,c=Object(s.useRef)(""),n=Object(s.useState)(null),r=Object(u.a)(n,2),a=r[0],i=r[1],o=Object(s.useContext)(p).user,l=Object(s.useState)(!0),j=Object(u.a)(l,2),d=(j[0],j[1]),O=function(e){return(e=e||"").replace(/(\n\r|\r\n|\r|\n)/g,"<br/>")},m=function(){var e=Object(v.a)(x.a.mark((function e(t){var s,n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s={userId:o._id,desc:O(c.current.value)},!a){e.next=15;break}return n=new FormData,r=Date.now()+a.name,n.append("fileName",r),n.append("file",a),s.img=r,e.prev=8,e.next=11,_().post("/upload",n);case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(8);case 15:return e.prev=15,e.next=18,_().post("/posts",s);case 18:window.location.reload(),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(15),console.log(e.t1);case 24:case"end":return e.stop()}}),e,null,[[8,13],[15,21]])})));return function(t){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){var e=function(){d(!0)};document.addEventListener("click",e);var t=function(){var e=Object(v.a)(x.a.mark((function e(){var t,s,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={userId:o._id,desc:O(c.current.value)},!a){e.next=14;break}return s=new FormData,n=Date.now()+a.name,s.append("fileName",n),s.append("file",a),t.img=n,e.prev=7,e.next=10,_().post("/upload",s);case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(7);case 14:return e.prev=14,e.next=17,_().post("/posts",t);case 17:window.location.reload(),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(14),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[7,12],[14,20]])})));return function(){return e.apply(this,arguments)}}(),s=function(e){13===e.keyCode&&e.ctrlKey&&t()};return document.addEventListener("keydown",s),function(){document.removeEventListener("keydown",s),document.removeEventListener("click",e)}}),[a,o]);var f=function(){return Object(b.jsx)("div",{className:"share",children:Object(b.jsxs)("div",{className:"shareWrapper",children:[Object(b.jsxs)("div",{className:"shareTop",children:[Object(b.jsx)("img",{src:"",alt:""}),Object(b.jsx)("textarea",{type:"text",placeholder:"\u6709\u4ec0\u4e48\u6709\u8da3\u7684\u4e8b\u60c5\u5206\u4eab\u7ed9\u5927\u5bb6?",className:"shareInput",ref:c})]}),Object(b.jsx)("hr",{className:"shareHr"}),a&&Object(b.jsx)("div",{className:"shareImageContainer",children:Object(b.jsx)("img",{alt:"",className:"shareImg",src:URL.createObjectURL(a)})}),Object(b.jsxs)("form",{className:"shareBottom",onSubmit:m,children:[Object(b.jsx)("div",{className:"shareOptions",children:Object(b.jsx)("div",{className:"shareOption",children:Object(b.jsxs)("label",{htmlFor:"file",className:"shareOptionText",children:[Object(b.jsx)(S.a,{htmlColor:"tomato",className:"shareIcon"}),Object(b.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return i(e.target.files[0])}})]})})}),Object(b.jsx)("button",{className:"shareButton",type:"submit",children:"\u53d1\u9001"})]})]})})};return void 0===t||t===(null===o||void 0===o?void 0:o.username)?Object(b.jsx)(f,{}):null}var I=c(123),C=c(57);c(93);function T(e){var t=e.post,c=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,n=Object(s.useState)(t.likes.length),r=Object(u.a)(n,2),a=r[0],i=r[1],o=Object(s.useState)(!1),j=Object(u.a)(o,2),d=j[0],O=j[1],m=Object(s.useState)(!1),f=Object(u.a)(m,2),h=f[0],g=f[1],N=Object(s.useState)({}),S=Object(u.a)(N,2),E=S[0],T=S[1],R=Object(s.useContext)(p).user;Object(s.useEffect)((function(){var e=function(){g(!1)};return document.addEventListener("click",e),function(){var e=Object(v.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("/users/?userId=".concat(t.userId));case 2:c=e.sent,T(c.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){document.removeEventListener("click",e)}}),[t.userId,g,h]);return Object(b.jsxs)("div",{className:"post",children:[Object(b.jsx)("div",{className:["postPop",h?"postPopShow":""].join(" "),children:Object(b.jsxs)("div",{className:"selected",children:[Object(b.jsx)("div",{onClick:function(){(function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userId!==R._id){e.next=5;break}return e.next=3,_().delete("posts/"+t._id,{data:{userId:R._id}});case 3:e.next=6;break;case 5:alert("\u4f60\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u535a\u5ba2");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),window.location.reload()},className:"selected__item",children:"\u5220\u9664"}),Object(b.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===R||void 0===R?void 0:R._id)===t.userId){e.next=6;break}return e.next=3,_().put("users/".concat(t.userId,"/follow"),{userId:null===R||void 0===R?void 0:R._id});case 3:alert("\u5173\u6ce8\u6210\u529f"),e.next=7;break;case 6:alert("\u4f60\u4e0d\u80fd\u5173\u6ce8\u81ea\u5df1");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u5173\u6ce8"}),Object(b.jsx)("div",{className:"selected__item",children:"\u7279\u522b\u5173\u6ce8"}),Object(b.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R._id===t.userId){e.next=7;break}return e.next=3,_().put("users/".concat(t.userId,"/unfollow"),{userId:R._id});case 3:alert("\u53d6\u6d88\u5173\u6ce8\u6210\u529f"),window.location.reload(),e.next=8;break;case 7:alert("\u4f60\u4e0d\u80fd\u53d6\u6d88\u5173\u6ce8\u81ea\u5df1");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u53d6\u6d88\u5173\u6ce8"})]})}),Object(b.jsxs)("div",{className:"postWrapper",children:[Object(b.jsxs)("div",{className:"postTop",children:[Object(b.jsxs)("div",{className:"postTopLeft",children:[Object(b.jsx)(l.b,{to:"/profile/".concat(E.username),children:Object(b.jsx)("img",{className:"postProfileImg",src:c+E.profilePicture||c+"person/noAvatar.png",alt:""})}),Object(b.jsx)("span",{className:"postUsername",children:E.username}),Object(b.jsx)("span",{className:"postDate",children:Object(C.a)(t.createdAt,"zh_CN")})]}),Object(b.jsx)("div",{className:"postTopRight",children:Object(b.jsx)(I.a,{onClick:function(e){e.nativeEvent.stopImmediatePropagation(),g(!h)}})})]}),Object(b.jsxs)("div",{className:"postCenter",children:[Object(b.jsx)("span",{className:"postText",dangerouslySetInnerHTML:{__html:t.desc}}),Object(b.jsx)("img",{src:c+t.img,alt:"",className:"postImg"})]}),Object(b.jsxs)("div",{className:"postBottom",children:[Object(b.jsxs)("div",{className:"postBottomLeft",children:[Object(b.jsx)("img",{src:"/assets/like.png",alt:"",className:"likeIcon",onClick:function(){i(d?a-1:a+1),O(!d)}}),Object(b.jsx)("span",{className:"postLikeCounter",children:a})]}),Object(b.jsx)("div",{className:"postBottomRight",children:Object(b.jsxs)("span",{className:"postCommentText",children:[t.comment," \u8bc4\u8bba"]})})]})]})]})}var R=c(7);function w(e){var t=e.username,c=Object(s.useState)([]),n=Object(u.a)(c,2),r=n[0],a=n[1],i=Object(s.useContext)(p).user;Object(R.h)();return Object(s.useEffect)((function(){(function(){var e=Object(v.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,_().get("posts/profile/"+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,_().get("posts/timeline/".concat(null===i||void 0===i?void 0:i._id));case 8:e.t0=e.sent;case 9:c=e.t0,a(c.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,i]),Object(b.jsx)("div",{className:"center",children:Object(b.jsxs)("div",{className:"centerWrapper",children:[Object(b.jsx)(E,{username:t}),r.map((function(e){return Object(b.jsx)(T,{post:e},e._id)}))]})})}c(94),c(95);function L(e){var t=e.user,c=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER;return Object(b.jsx)(l.b,{to:"/profile/".concat(t.username),children:Object(b.jsxs)("li",{className:"rightbarFriend",children:[Object(b.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(b.jsx)("img",{src:t.profilePicture?c+t.profilePicture:c+"person/noAvatar.png",alt:"",className:"rightbarProfileImg"}),Object(b.jsx)("span",{className:"rightbarOnline"})]}),Object(b.jsx)("span",{className:"rightbarUsername",children:t.username})]})})}c(96);var P=c(124),y=c(125);function k(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),c=t[0],n=t[1],r=function(){n(!c)},a=Object(s.useContext)(p).user,i=Object(s.useState)({}),o=Object(u.a)(i,2),j=o[0],d=o[1];return Object(s.useEffect)((function(){(function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("users/".concat(a._id));case 2:t=e.sent,d(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a,d]),Object(b.jsxs)("div",{className:"box",children:[Object(b.jsxs)("div",{className:"header",children:[Object(b.jsx)(l.b,{to:j?"/profile/".concat(j.username):"/",children:Object(b.jsx)("img",{src:j.profilePicture||"person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(b.jsx)("div",{children:j.username}),c?Object(b.jsx)("span",{className:"dark",onClick:r,children:Object(b.jsx)(P.a,{})}):Object(b.jsx)("span",{className:"light",onClick:r,children:Object(b.jsx)(y.a,{})})]}),Object(b.jsx)(l.b,{to:"/portfolio",children:"\u6211\u7684\u4f5c\u54c1\u96c6"}),Object(b.jsx)(l.b,{to:"/filter",children:"\u6211\u7684\u6ee4\u955c"})]})}function D(e){var t=e.user,c=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,n=Object(s.useState)([]),r=Object(u.a)(n,2),a=r[0],i=r[1],o=Object(s.useContext)(p).user,j=Object(s.useState)([]),d=Object(u.a)(j,2),O=d[0],m=d[1];Object(s.useEffect)((function(){(function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("users/friends/".concat(null===o||void 0===o?void 0:o._id));case 2:t=e.sent,i(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[o]),Object(s.useEffect)((function(){(function(){var e=Object(v.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("users/circle/".concat(null===t||void 0===t?void 0:t._id));case 2:c=e.sent,m(c.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var f=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(k,{}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u6211\u7684\u5173\u6ce8"}),Object(b.jsx)("ul",{className:"rightbarFriendList",children:a.map((function(e){return Object(b.jsx)(L,{user:e},e._id)}))}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u63a8\u8350\u5173\u6ce8"})]})},h=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u7b80\u4ecb"}),Object(b.jsxs)("div",{className:"rightbarInfo",children:[Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u5c45\u4f4f\u5730:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.city})]}),Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u5bb6\u4e61:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.from})]}),Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u804c\u4e1a:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.relationship})]})]}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u597d\u53cb\u5708"}),Object(b.jsx)("div",{className:"rightbarFollowings",children:O.map((function(e){return Object(b.jsx)(l.b,{to:"/profile/".concat(e.username),children:Object(b.jsxs)("div",{className:"rightbarFollowing",children:[Object(b.jsx)("img",{src:t.profilePicture?c+t.profilePicture:c+"person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(b.jsx)("span",{className:"rightbarFollowingName",children:e.username})]})},e._id)}))})]})};return Object(b.jsx)("div",{className:"rightbar",children:Object(b.jsx)("div",{className:"rightbarWrapper",children:t?Object(b.jsx)(h,{}):Object(b.jsx)(f,{})})})}c(97);var F=c(126),A=c(127),U=c(128);function W(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,t=Object(s.useContext)(p).user,c=Object(s.useState)({}),n=Object(u.a)(c,2),r=n[0],a=n[1];Object(s.useEffect)((function(){(function(){var e=Object(v.a)(x.a.mark((function e(){var c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("users/".concat(t._id));case 2:c=e.sent,a(c.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,a]);return Object(b.jsxs)("div",{className:"topbarContainer",children:[Object(b.jsx)("div",{className:"topbarLeft",children:Object(b.jsx)(l.b,{to:"/",children:Object(b.jsx)("span",{className:"logo",children:"Fujix"})})}),Object(b.jsx)("div",{className:"topbarCenter",children:Object(b.jsxs)("div",{className:"searchbar",children:[Object(b.jsx)(F.a,{className:"searchIcon"}),Object(b.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u597d\u53cb\u6216\u8005\u6709\u8da3\u7684\u4e8b\u60c5",className:"searchInput"})]})}),Object(b.jsxs)("div",{className:"topbarRight",children:[Object(b.jsx)(l.b,{to:r?"/profile/".concat(r.username):"/",children:Object(b.jsx)("img",{src:e+r.profilePicture||e+"person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(b.jsx)(l.b,{to:"/",children:Object(b.jsx)("span",{className:"home",children:Object(b.jsx)(A.a,{})})}),Object(b.jsx)(l.b,{to:"/setting",children:Object(b.jsx)("span",{className:"setting",children:Object(b.jsx)(U.a,{})})}),Object(b.jsx)("span",{className:"logout",onClick:function(){j.clear(),window.location.reload()},children:"\u767b\u51fa"})]})]})}c(98);function B(e){var t=e.children;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(W,{}),Object(b.jsx)("div",{className:"homeContainer",children:t})]})}function K(){return Object(b.jsxs)(B,{children:[Object(b.jsx)(f,{}),Object(b.jsx)(w,{}),Object(b.jsx)(D,{home:!0})]})}c(99);function H(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,t=Object(s.useState)({}),c=Object(u.a)(t,2),n=c[0],r=c[1],a=Object(R.i)().username,i=Object(s.useState)(null),o=Object(u.a)(i,2),l=o[0],j=o[1];return Object(s.useEffect)((function(){var e=function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_().get("/users?username=".concat(a));case 2:t=e.sent,r(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){e=null}}),[a]),Object(s.useEffect)((function(){}),[l]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(W,{}),Object(b.jsx)("div",{className:"profile",children:Object(b.jsxs)("div",{className:"profileRight",children:[Object(b.jsxs)("div",{className:"profileRightTop",children:[Object(b.jsxs)("div",{className:"profileCover",children:[Object(b.jsx)("img",{src:n.coverPicture||e+"person/noCover.png",alt:"",className:"profileCoverImg"}),Object(b.jsxs)("label",{htmlFor:"file",children:[l?Object(b.jsx)("img",{alt:"",className:"profileUserImg",src:URL.createObjectURL(l)}):Object(b.jsx)("img",{src:e+n.profilePicture||e+"person/noAvatar.png",alt:"",className:"profileUserImg"}),Object(b.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return j(e.target.files[0])}})]})]}),Object(b.jsxs)("div",{className:"profileInfo",children:[Object(b.jsx)("div",{className:"profileInfoName",children:n.username}),Object(b.jsx)("div",{className:"profileInfoDesc",children:n.desc})]})]}),Object(b.jsxs)("div",{className:"profileRightBottom",children:[Object(b.jsx)(w,{username:a}),Object(b.jsx)(D,{user:n})]})]})})]})}var V=function(){var e=Object(v.a)(x.a.mark((function e(t,c){var s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({type:"LOGIN_START"}),e.prev=1,e.next=4,_().post("auth/login",t);case 4:s=e.sent,c({type:"LOGIN_SUCCESS",payload:s.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),c({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,c){return e.apply(this,arguments)}}(),q=c(129);c(100);function G(){var e=Object(s.useContext)(p),t=e.isFetching,c=e.dispatch,n=Object(s.useRef)(),r=Object(s.useRef)(),a=Object(R.g)(),i=function(e){null===e||void 0===e||e.preventDefault(),V({email:n.current.value,password:r.current.value},c),a.push("/")};Object(s.useEffect)((function(){var e=function(e){13===e.keyCode&&i()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}));return Object(b.jsx)("div",{className:"login",children:Object(b.jsxs)("div",{className:"loginWrapper",children:[Object(b.jsxs)("div",{className:"loginLeft",children:[Object(b.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(b.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(b.jsx)("div",{className:"loginRight",children:Object(b.jsxs)("form",{className:"loginBox",onSubmit:i,children:[Object(b.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",type:"email",required:!0,ref:n}),Object(b.jsx)("input",{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",className:"loginInput",type:"password",required:!0,minLength:"6",ref:r}),Object(b.jsx)("button",{className:"loginButton",children:t?Object(b.jsx)(q.a,{primary:"true"}):"\u767b\u9646"}),Object(b.jsx)("span",{className:"loginForgot",children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"}),Object(b.jsx)("button",{className:"loginRegisterButton",onClick:function(){a.push("/register")},children:"\u521b\u5efa\u65b0\u8d26\u53f7"})]})})]})})}c(101);function J(){var e=Object(s.useRef)(),t=Object(s.useRef)(),c=Object(s.useRef)(),n=Object(s.useRef)(),r=Object(R.g)();return Object(b.jsx)("div",{className:"login",children:Object(b.jsxs)("div",{className:"loginWrapper",children:[Object(b.jsxs)("div",{className:"loginLeft",children:[Object(b.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(b.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(b.jsx)("div",{className:"loginRight",children:Object(b.jsxs)("form",{className:"loginBox",onSubmit:function(s){(s.preventDefault(),e.current.value===c.current.value)?(function(){var c=Object(v.a)(x.a.mark((function c(){var s;return x.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,_().post("auth/register",{username:t.current.value,password:e.current.value,email:n.current.value});case 3:s=c.sent,console.log(s),c.next=10;break;case 7:c.prev=7,c.t0=c.catch(0),console.log(c.t0);case 10:case"end":return c.stop()}}),c,null,[[0,7]])})));return function(){return c.apply(this,arguments)}}()(),r.push("/login")):alert("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u540c")},children:[Object(b.jsx)("input",{placeholder:"\u7528\u6237\u540d",className:"loginInput",ref:t,required:!0}),Object(b.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",ref:n,required:!0,type:"email"}),Object(b.jsx)("input",{placeholder:"\u5bc6\u7801",className:"loginInput",ref:e,type:"password",minLength:"6",required:!0}),Object(b.jsx)("input",{placeholder:"\u518d\u6b21\u786e\u8ba4\u5bc6\u7801",className:"loginInput",ref:c,type:"password",required:!0}),Object(b.jsx)("button",{className:"loginButton",type:"submit",children:"\u6ce8\u518c"}),Object(b.jsx)("button",{className:"loginRegisterButton",onClick:function(){r.push("/login")},children:"\u767b\u9646"})]})})]})})}var z=c(58),M=c(27),Q=(c(102),c(130));function X(){var e=Object(s.useContext)(p).user,t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,c=Object(s.useState)(null),n=Object(u.a)(c,2),r=n[0],a=n[1],i=Object(s.useState)({}),o=Object(u.a)(i,2),l=o[0],j=o[1],d=l.username,O=l.city,m=l.from,f=l.desc;Object(s.useEffect)((function(){(function(){var t=Object(v.a)(x.a.mark((function t(){var c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_().get("users/".concat(e._id));case 2:c=t.sent,j(c.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e,j]);var h=function(t){var c=Object(z.a)({userId:null===e||void 0===e?void 0:e._id},t);(function(){var t=Object(v.a)(x.a.mark((function t(){var s,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!r){t.next=9;break}return s=new FormData,n=Date.now()+r.name,s.append("fileName",n),s.append("file",r),c.profilePicture=n,t.next=9,_().post("/upload",s);case 9:return t.next=11,_().put("users/".concat(e._id),c);case 11:alert("\u4fdd\u5b58\u6210\u529f"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(){return t.apply(this,arguments)}})()()},g=function(){return Object(b.jsx)("div",{className:"form",children:Object(b.jsxs)("div",{className:"formWrapper",children:[Object(b.jsxs)("h2",{className:"heading",children:[Object(b.jsx)(U.a,{fontSize:"large"}),"\u8bbe\u7f6e"]}),Object(b.jsxs)("label",{htmlFor:"file",children:[r?Object(b.jsx)("img",{alt:"",className:"userImg",src:URL.createObjectURL(r)}):Object(b.jsx)("img",{src:t+l.profilePicture||t+"person/noAvatar.png",alt:"",className:"userImg"}),Object(b.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return a(e.target.files[0])}})]}),Object(b.jsx)(M.c,{initialValues:{username:d,city:O,from:m,desc:f},onSubmit:h,children:Object(b.jsxs)(M.b,{className:"formBasic",children:[Object(b.jsx)("label",{htmlFor:"username",children:"\u7528\u6237\u540d\u5b57"}),Object(b.jsx)(M.a,{id:"username",name:"username",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"desc",children:"\u7b80\u4ecb"}),Object(b.jsx)(M.a,{id:"desc",name:"desc",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"city",children:"\u57ce\u5e02"}),Object(b.jsx)(M.a,{id:"city",name:"city",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"from",children:"\u5bb6\u4e61"}),Object(b.jsx)(M.a,{id:"from",name:"from",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)(Q.a,{variant:"contained",color:"primary",type:"submit",children:"\u4fdd\u5b58\u8bbe\u7f6e"})]})})]})})};return Object(b.jsxs)(B,{children:[Object(b.jsx)("div",{className:"sidebar"}),Object(b.jsx)("div",{className:"center",children:Object(b.jsx)(g,{})}),Object(b.jsx)("div",{className:"rightbar",children:Object(b.jsx)(k,{})})]})}c(103);function Y(){var e=Object(s.useContext)(p).user,t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PUBLIC_FOLDER,c=function(e){var t=Object(s.useState)([]),c=Object(u.a)(t,2),n=c[0],r=c[1];return Object(s.useEffect)((function(){!function(){var t=Object(v.a)(x.a.mark((function t(){var c,s,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_().get(e);case 3:s=t.sent,n=null===(c=s.data)||void 0===c?void 0:c.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),r(n.filter((function(e){return void 0!=e.img}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),n}("posts/portfolio/".concat(null===e||void 0===e?void 0:e._id));return Object(b.jsxs)(B,{children:[Object(b.jsx)("div",{className:"imageWrapper",children:c.map((function(e){return Object(b.jsx)("img",{src:t+e.img,alt:"",className:"portfolioImg"},e._id)}))}),Object(b.jsx)(D,{})]})}function Z(){return Object(b.jsx)("div",{children:Object(b.jsx)("h1",{children:"404"})})}var $=function(){var e=Object(s.useContext)(p).user;return Object(b.jsx)(l.a,{children:Object(b.jsxs)(R.d,{children:[Object(b.jsxs)(R.b,{path:"/",exact:!0,children:[e&&Object(b.jsx)(K,{}),!e&&Object(b.jsx)(R.a,{to:"/login"})]}),Object(b.jsxs)(R.b,{path:"/login",children:[e&&Object(b.jsx)(R.a,{to:"/"}),!e&&Object(b.jsx)(G,{})]}),Object(b.jsxs)(R.b,{path:"/portfolio",children:[e&&Object(b.jsx)(Y,{}),!e&&Object(b.jsx)(R.a,{to:"/"})]}),Object(b.jsx)(R.b,{path:"/register",children:Object(b.jsx)(J,{})}),Object(b.jsxs)(R.b,{path:"/profile/:username",children:[e&&Object(b.jsx)(H,{}),!e&&Object(b.jsx)(R.a,{to:"/login"})]}),Object(b.jsxs)(R.b,{path:"/setting",children:[e&&Object(b.jsx)(X,{}),!e&&Object(b.jsx)(R.a,{to:"/login"})]}),Object(b.jsx)(R.b,{path:"*",children:Object(b.jsx)(Z,{})})]})})};c(104);r.a.render(Object(b.jsx)(m,{children:Object(b.jsx)($,{})}),document.getElementById("root"))},66:function(e,t,c){},91:function(e,t,c){},92:function(e,t,c){},93:function(e,t,c){},94:function(e,t,c){},95:function(e,t,c){},96:function(e,t,c){},97:function(e,t,c){},98:function(e,t,c){},99:function(e,t,c){}},[[105,1,2]]]);
//# sourceMappingURL=main.f7233f5a.chunk.js.map