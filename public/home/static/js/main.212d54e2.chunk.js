(this["webpackJsonpreact-sm"]=this["webpackJsonpreact-sm"]||[]).push([[0],{82:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(24),r=n.n(s),a=n(3),o=n.n(a),l=n(5),i=n(4),u=n(45),d=n.n(u),j=n(28),b={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},remove:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()}},f=d.a.create({baseURL:"/api",timeout:4e4});f.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+b.get("token")||!1,e})),f.interceptors.response.use((function(e){return e}),(function(e){var t,n;return console.log(e.response),Object(j.b)(null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message),Promise.reject(e)}));var x=f,m=n(98),p=n(99),h=n(100),O=n(6),v=n(1),g={user:null},w=Object(c.createContext)(g),y=function(e){var t=e.children,n=Object(c.useState)(b.get("user")||null),s=Object(i.a)(n,2),r=s[0],a=s[1];return Object(v.jsx)(w.Provider,{value:{user:r,setUser:a},children:t})},N=n(96);function k(e){var t=e.username,n=Object(c.useRef)(""),s=Object(c.useState)(null),r=Object(i.a)(s,2),a=r[0],u=r[1],d=Object(c.useContext)(w).user,j=Object(c.useState)(!0),b=Object(i.a)(j,2),f=(b[0],b[1]),m=function(e){return(e=e||"").replace(/(\n\r|\r\n|\r|\n)/g,"<br/>")},p=function(){var e=Object(l.a)(o.a.mark((function e(t){var c,s,r,l,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={userId:d._id,desc:m(n.current.value)},!a){e.next=17;break}return s=new FormData,r=Date.now()+a.name,s.append("fileName",r),s.append("file",a),e.prev=7,e.next=10,x.post("/upload",s);case 10:l=e.sent,i=l.data,c.img=i,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(7);case 17:return e.prev=17,e.next=20,x.post("/posts",c);case 20:window.location.reload(),e.next=25;break;case 23:e.prev=23,e.t1=e.catch(17);case 25:case"end":return e.stop()}}),e,null,[[7,15],[17,23]])})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=function(){f(!0)};document.addEventListener("click",e);var t=function(){var e=Object(l.a)(o.a.mark((function e(){var t,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={userId:d._id,desc:m(n.current.value)},!a){e.next=14;break}return c=new FormData,s=Date.now()+a.name,c.append("fileName",s),c.append("file",a),t.img=s,e.prev=7,e.next=10,x.post("/upload",c);case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(7);case 14:return e.prev=14,e.next=17,x.post("/posts",t);case 17:window.location.reload(),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(14),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[7,12],[14,20]])})));return function(){return e.apply(this,arguments)}}(),c=function(e){13===e.keyCode&&e.ctrlKey&&t()};return document.addEventListener("keydown",c),function(){document.removeEventListener("keydown",c),document.removeEventListener("click",e)}}),[a,d]);var h=function(){return Object(v.jsxs)("div",{className:"w-full p-4 bg-white shadow-lg rounded-md  dark:bg-gray-800 dark:text-gray-200",children:[Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)("img",{src:"",alt:""}),Object(v.jsx)("textarea",{type:"text",placeholder:"\u6709\u4ec0\u4e48\u6709\u8da3\u7684\u4e8b\u60c5\u5206\u4eab\u7ed9\u5927\u5bb6?",className:"w-full resize-none outline-none dark:bg-gray-800 dark:text-gray-200",ref:n})]}),Object(v.jsx)("hr",{className:"my-4"}),a&&Object(v.jsx)("div",{className:"flex justify-center items-center",children:Object(v.jsx)("img",{alt:"",className:"rounded-sm max-h-96 shadow-lg",src:URL.createObjectURL(a)})}),Object(v.jsxs)("form",{className:"flex justify-between",onSubmit:p,children:[Object(v.jsx)("div",{className:"",children:Object(v.jsxs)("label",{htmlFor:"file",className:"",children:[Object(v.jsx)(N.a,{htmlColor:"tomato",className:""}),Object(v.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return u(e.target.files[0])}})]})}),Object(v.jsx)("button",{className:"",type:"submit",children:"\u53d1\u9001"})]})]})};return void 0===t||t===(null===d||void 0===d?void 0:d.username)?Object(v.jsx)(h,{}):null}var C,E=n(97),S=n(50),_=new WeakMap;function I(e){e.forEach((function(e){var t=e.target;if(_.has(t)){var n,c=_.get(t);if(e.isIntersecting||e.intersectionRatio>0)t.src=null!==(n=t.dataset.src)&&void 0!==n?n:"",C.unobserve(t),_.delete(t),c()}}))}function A(){return void 0===C&&(C=new IntersectionObserver(I,{rootMargin:"100px",threshold:"0.15"})),C}function L(e,t){Object(c.useEffect)((function(){var n=e.current,c=A();return _.set(n,t),c.observe(n),function(){_.delete(n),c.unobserve(n)}}),[])}function D(e){var t=e.post,n=Object(c.useState)(t.likes.length),s=Object(i.a)(n,2),r=(s[0],s[1],Object(c.useState)(!1)),a=Object(i.a)(r,2),u=(a[0],a[1],Object(c.useState)(!1)),d=Object(i.a)(u,2),j=d[0],b=d[1],f=Object(c.useRef)();L(f,(function(){}));var m=Object(c.useState)({}),p=Object(i.a)(m,2),h=p[0],g=p[1],y=Object(c.useContext)(w).user;Object(c.useEffect)((function(){var e=function(){b(!1)};return document.addEventListener("click",e),function(){var e=Object(l.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/users/?userId=".concat(t.userId));case 2:n=e.sent,g(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){document.removeEventListener("click",e)}}),[t.userId,b,j]);var N=function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userId!==y._id){e.next=5;break}return e.next=3,x.delete("posts/"+t._id,{data:{userId:y._id}});case 3:e.next=6;break;case 5:alert("\u4f60\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u535a\u5ba2");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),window.location.reload()};return Object(v.jsxs)("div",{className:"flex flex-col relative",children:[Object(v.jsxs)("div",{className:"".concat(j?"inline-flex":"hidden"," flex-col  bg-white text-gray-600  w-40 text-center rounded-md space-y-2 cursor-pointer absolute top-20 right-0 z-20 shadow-2xl overflow-hidden dark:bg-gray-800 dark:text-gray-200"),children:[Object(v.jsx)("span",{className:"hover:bg-pink-400 hover:text-white p-2",onClick:function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===y||void 0===y?void 0:y._id)===t.userId){e.next=6;break}return e.next=3,x.put("users/".concat(t.userId,"/follow"),{userId:null===y||void 0===y?void 0:y._id});case 3:alert("\u5173\u6ce8\u6210\u529f"),e.next=7;break;case 6:alert("\u4f60\u4e0d\u80fd\u5173\u6ce8\u81ea\u5df1");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u5173\u6ce8"}),Object(v.jsx)("span",{className:"hover:bg-pink-400 hover:text-white p-2",onClick:function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y._id===t.userId){e.next=7;break}return e.next=3,x.put("users/".concat(t.userId,"/unfollow"),{userId:y._id});case 3:alert("\u53d6\u6d88\u5173\u6ce8\u6210\u529f"),window.location.reload(),e.next=8;break;case 7:alert("\u4f60\u4e0d\u80fd\u53d6\u6d88\u5173\u6ce8\u81ea\u5df1");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u53d6\u6d88\u5173\u6ce8"}),Object(v.jsx)("span",{className:"hover:bg-pink-400 hover:text-white p-2",onClick:N,children:"\u5220\u9664"}),Object(v.jsx)("span",{className:"hover:bg-pink-400 hover:text-white p-2",onClick:N,children:"\u52a0\u5165\u7279\u522b\u5173\u6ce8"})]}),Object(v.jsxs)("div",{className:"flex flex-col bg-white rounded-md shadow-lg text-gray-600 p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200",children:[Object(v.jsxs)("div",{className:"flex justify-between items-center",children:[Object(v.jsxs)("div",{className:"flex items-center space-x-4",children:[Object(v.jsx)(O.b,{to:"/profile/".concat(h.username),children:Object(v.jsx)("img",{className:"w-102 h-10 object-cover rounded-full",src:h.profilePicture||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png",alt:""})}),Object(v.jsx)("span",{className:"",children:h.username}),Object(v.jsx)("span",{className:"",children:Object(S.a)(t.createdAt,"zh_CN")})]}),Object(v.jsx)("div",{className:"",children:Object(v.jsx)(E.a,{onClick:function(e){e.nativeEvent.stopImmediatePropagation(),b(!j)},className:"cursor-pointer"})})]}),Object(v.jsxs)("div",{className:"flex flex-col space-y-4",children:[Object(v.jsx)("span",{className:"",dangerouslySetInnerHTML:{__html:t.desc}}),Object(v.jsx)("img",{src:null,alt:"",className:"rounded-sm","data-src":t.img,ref:f})]})]})]})}var R=n(7);function F(e){var t=e.username,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],a=s[1],u=Object(c.useContext)(w).user,d=Object(R.h)().search.split("=").pop();return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var n,c,s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=7;break}return e.next=3,x.get("posts/friends/".concat(d));case 3:c=e.sent,a(null===(n=c.data)||void 0===n?void 0:n.flat().sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}))),e.next=18;break;case 7:if(!t){e.next=13;break}return e.next=10,x.get("posts/profile/"+t);case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,x.get("posts/timeline/now");case 15:e.t0=e.sent;case 16:r=e.t0,a(null===(s=r.data)||void 0===s?void 0:s.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,d]),Object(v.jsxs)("div",{className:"w-full",children:[!t&&Object(v.jsxs)("div",{className:"hidden lg:block w-56 bg-white text-gray-600 rounded-md p-4 space-y-4 shadow-lg fixed dark:bg-gray-800 dark:text-gray-200 ",children:[Object(v.jsx)("h3",{className:"",children:"\u9996\u9875"}),Object(v.jsxs)("div",{className:"flex flex-col space-y-4",children:[Object(v.jsxs)(O.b,{to:"/home/share",children:[Object(v.jsx)(m.a,{}),Object(v.jsx)("span",{className:"pl-4",children:"\u5168\u90e8\u5173\u6ce8"})]}),Object(v.jsxs)(O.b,{to:"/",children:[Object(v.jsx)(p.a,{}),Object(v.jsx)("span",{className:"pl-4",children:"\u7279\u522b\u5173\u6ce8"})]}),Object(v.jsxs)(O.b,{to:"?userId=".concat(null===u||void 0===u?void 0:u._id),children:[Object(v.jsx)(h.a,{}),Object(v.jsx)("span",{className:"pl-4",children:"\u597d\u53cb\u5708"})]})]})]}),Object(v.jsxs)("div",{className:"w-full  lg:w-9/12  ml-auto space-y-8 ",children:[Object(v.jsx)(k,{username:t}),r.map((function(e){return Object(v.jsx)(D,{post:e},e._id)}))]})]})}function P(e){var t=e.user;return Object(v.jsx)(O.b,{to:"/profile/".concat(t.username),children:Object(v.jsxs)("li",{className:"text-gray-600 flex items-center justify-between dark:text-gray-200",children:[Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)("img",{src:t.profilePicture?t.profilePicture:"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png",alt:"",className:"w-12 h-12 object-cover rounded-full"}),Object(v.jsx)("span",{className:""})]}),Object(v.jsx)("span",{className:"",children:t.username})]})})}var z=n(101),U=n(102),q=function(e){var t=Object(c.useState)({}),n=Object(i.a)(t,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){(function(){var t=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.get(e);case 2:n=t.sent,r(n.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),[s]};function M(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useContext)(w).user,a="users/".concat(null===r||void 0===r?void 0:r._id),o=q(a),l=Object(i.a)(o,1)[0];return Object(c.useEffect)((function(){b.get("theme")?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark")})),Object(c.useMemo)((function(){return Object(v.jsxs)("div",{className:"bg-white p-4 text-gray-600 flex flex-col space-y-6 shadow-lg rounded-md dark:bg-gray-800 dark:text-gray-200",children:[Object(v.jsxs)("div",{className:"flex justify-between items-center",children:[Object(v.jsx)(O.b,{to:l?"/profile/".concat(l.username):"/",children:Object(v.jsx)("img",{src:(null===l||void 0===l?void 0:l.profilePicture)||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png",className:"w-16 h-16 object-cover rounded-md",alt:"avatart"})}),Object(v.jsx)("div",{children:null===l||void 0===l?void 0:l.username}),n?Object(v.jsx)("span",{className:"cursor-pointer",onClick:function(){s(!1),b.set("theme",n),document.documentElement.classList.add("dark")},children:Object(v.jsx)(z.a,{})}):Object(v.jsx)("span",{className:"cursor-pointer",onClick:function(){s(!0),b.set("theme",n),document.documentElement.classList.remove("dark")},children:Object(v.jsx)(U.a,{})})]}),Object(v.jsx)(O.b,{to:"/home",className:"text-center hover:text-pink-400",children:"\u5206\u4eab\u4e00\u523b"}),Object(v.jsx)(O.b,{to:"/home/photos",className:"text-center  hover:text-pink-400",children:"\u7167\u7247\u6d41"}),Object(v.jsx)(O.b,{to:"/home/timeline",className:"text-center hover:text-pink-400",children:"\u65f6\u523b\u5c9b"})]})}),[l,n])}function T(e){var t=e.user,n=Object(c.useState)([]),s=Object(i.a)(n,2),r=s[0],a=s[1],u=Object(c.useContext)(w).user,d=Object(c.useState)([]),j=Object(i.a)(d,2),b=j[0],f=j[1];Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("users/friends/".concat(null===u||void 0===u?void 0:u._id));case 2:t=e.sent,a(null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[u]),Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("users/circle/".concat(null===u||void 0===u?void 0:u._id));case 2:t=e.sent,f(null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[u]);var m=function(){return Object(v.jsxs)("div",{className:"flex flex-col space-y-6 ml-4",children:[Object(v.jsx)(M,{}),Object(v.jsxs)("div",{className:"bg-white p-4 text-gray-600 flex flex-col space-y-4 shadow-lg rounded-md dark:bg-gray-800 dark:text-gray-100",children:[Object(v.jsx)("h4",{className:"",children:"\u6211\u7684\u5173\u6ce8"}),Object(v.jsx)("ul",{className:"flex flex-col space-y-4",children:r&&r.map((function(e){return Object(v.jsx)(P,{user:e},null===e||void 0===e?void 0:e._id)}))})]})]})},p=function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"rounded-md shadow-xl p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200",children:[Object(v.jsx)("div",{children:"\u7b80\u4ecb"}),Object(v.jsxs)("div",{className:"",children:[Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)("span",{className:"",children:"\u5c45\u4f4f\u5730:"}),Object(v.jsx)("span",{className:"",children:t.city})]}),Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)("span",{className:"",children:"\u5bb6\u4e61:"}),Object(v.jsx)("span",{className:"",children:t.from})]}),Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)("span",{className:"",children:"\u804c\u4e1a:"}),Object(v.jsx)("span",{className:"",children:t.relationship})]})]})]}),Object(v.jsxs)("div",{className:"rounded-md shadow-xl p-4 space-y-4 dark:bg-gray-800 dark:text-gray-200",children:[Object(v.jsx)("h4",{className:"",children:"\u597d\u53cb\u5708"}),b&&b.map((function(e){return Object(v.jsx)(O.b,{to:"/profile/".concat(e.username),className:"block",children:Object(v.jsxs)("div",{className:"flex items-center justify-between",children:[Object(v.jsx)("img",{src:e.profilePicture?e.profilePicture:"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png",alt:"",className:"w-16 h-16 object-cover rounded-full"}),Object(v.jsx)("span",{className:"",children:null===e||void 0===e?void 0:e.username})]})},null===e||void 0===e?void 0:e._id)}))]})]})};return Object(v.jsx)(v.Fragment,{children:t?Object(v.jsx)(p,{}):Object(v.jsx)(m,{})})}var J=n(103),Y=n(104),B=n(105);function H(){var e=Object(c.useContext)(w).user,t=Object(R.g)(),n=e?"users/".concat(e._id):"",s=q(n),r=Object(i.a)(s,1)[0];return Object(v.jsxs)("div",{className:"h-12 mx-auto max-w-7xl w-full bg-white flex items-center text-gray-700 dark:bg-gray-800 dark:text-white ",children:[Object(v.jsx)("div",{className:"w-3/12",children:Object(v.jsx)(O.b,{to:"/home",children:Object(v.jsx)("span",{className:"text-2xl  ml-6 cursor-pointer font-bold",children:"Fujix"})})}),Object(v.jsx)("div",{className:"w-5/12",children:Object(v.jsxs)("div",{className:"w-full  flex items-center rounded-full h-8 bg-gray-100",children:[Object(v.jsx)(J.a,{className:"ml-2"}),Object(v.jsx)("input",{type:"text",placeholder:"",className:"outline-none pl-2 w-3/5 bg-gray-100"})]})}),Object(v.jsxs)("div",{className:"w-4/12 flex items-center justify-evenly ",children:[Object(v.jsx)(O.b,{to:r?"/profile/".concat(r.username):"/",children:Object(v.jsx)("img",{src:r.profilePicture||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png",className:"rounded-full text-lg object-cover h-8 w-8",alt:"avatart"})}),Object(v.jsx)(O.b,{to:"/home",children:Object(v.jsx)("span",{children:Object(v.jsx)(Y.a,{})})}),Object(v.jsx)(O.b,{to:"/setting",children:Object(v.jsx)("span",{children:Object(v.jsx)(B.a,{})})}),Object(v.jsx)("span",{onClick:function(){t.push("/login"),b.clear()},className:"cursor-pointer",children:"\u767b\u51fa"})]})]})}function V(e){var t=e.children;return Object(v.jsxs)("div",{className:"scoll-min dark:bg-gray-600",children:[Object(v.jsx)("div",{className:"sticky top-0 z-50 bg-white shadow-md dark:bg-gray-800",children:Object(v.jsx)(H,{})}),Object(v.jsx)("div",{className:"mx-auto max-w-7xl my-10 dark:bg-gray-600",children:Object(v.jsx)("div",{className:"flex",children:t})})]})}function G(e){var t=e.post,n=Object(c.useState)(!1),s=Object(i.a)(n,2),r=s[0],a=s[1],o=Object(c.useRef)();return L(o,(function(){a(!0)})),Object(v.jsx)("img",{alt:"",src:null,"data-src":t.img,ref:o,className:"w-1/3 max-h-80 object-cover opacity-95 p-2 scale-100 cursor-pointer transform  transition duration-500 ease-in-out  hover:opacity-100  hover:scale-105 ".concat(r?"":"filter blur")})}function K(){var e=Object(c.useContext)(w).user,t=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),s=n[0],r=n[1];return Object(c.useEffect)((function(){!function(){var t=Object(l.a)(o.a.mark((function t(){var n,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.get(e);case 3:c=t.sent,s=null===(n=c.data)||void 0===n?void 0:n.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),r(s.filter((function(e){return void 0!==e.img}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),s}("posts/portfolio/".concat(null===e||void 0===e?void 0:e._id));return Object(v.jsx)("div",{className:"flex flex-wrap  bg-white p-4 rounded-md mb-10 dark:bg-gray-800",children:t.map((function(e){return Object(v.jsx)(G,{post:e},e._id)}))})}var W=n(46),Q=n.n(W),X=n(47);function Z(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(c.useContext)(w).user;return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("posts/profile/".concat(r.username));case 2:n=e.sent,c=null===(t=n.data)||void 0===t?void 0:t.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),a=[],c.forEach((function(e){if(""!==e.desc){var t={};t.title=Q()(e.createdAt).format("DD/MM/YYYY"),t.cardDetailedText=e.desc,a.push(t)}})),s(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]),Object(v.jsx)("div",{className:"dark:bg-gray-800 dark:text-gray-200  p-4 pb-24 mb-20 overflow-hidden rounded-md shadow-lg bg-white",children:Object(v.jsxs)("div",{className:"text-center my-4",children:[Object(v.jsx)("div",{}),n&&Object(v.jsx)(X.a,{slideShow:!0,items:n,mode:"VERTICAL_ALTERNATING",hideControls:!0,useReadMore:!1,allowDynamicUpdate:!0,scrollable:!0})]})})}function $(){return Object(v.jsx)("div",{children:Object(v.jsx)("h1",{children:"Filter"})})}function ee(e){return Object(v.jsxs)(V,{children:[Object(v.jsx)("div",{className:"w-full sm:w-9/12 m-4 sm:m-0",children:Object(v.jsxs)(R.d,{children:[Object(v.jsx)(R.b,{path:"/home/photos",component:K}),Object(v.jsx)(R.b,{path:"/home/timeline",component:Z}),Object(v.jsx)(R.b,{path:"/home/filter",component:$}),Object(v.jsx)(R.b,{path:"/home",component:F})]})}),Object(v.jsx)("div",{className:"hidden sm:block sm:w-3/12",children:Object(v.jsx)(T,{home:!0})})]})}function te(){var e=Object(c.useState)({}),t=Object(i.a)(e,2),n=t[0],s=t[1],r=Object(R.i)().username;return Object(c.useEffect)((function(){var e=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/users?username=".concat(r));case 2:t=e.sent,s(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){e=null}}),[r]),Object(v.jsx)(V,{children:Object(v.jsxs)("div",{className:"bg-white rounded-sm shadow-lg w-full dark:bg-gray-600 overflow-hidden",children:[Object(v.jsxs)("div",{className:"",children:[Object(v.jsxs)("div",{className:"relative",children:[Object(v.jsx)("img",{src:n.coverPicture||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png",alt:"",className:"w-full h-52 object-cover"}),Object(v.jsx)("img",{src:n.profilePicture||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noAvatar.png",alt:"",className:"w-32 h-32 object-cover rounded-full absolute top-full left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]}),Object(v.jsxs)("div",{className:"mt-20 text-center dark:text-gray-200",children:[Object(v.jsx)("div",{className:"",children:n.username}),Object(v.jsx)("div",{className:"",children:n.desc}),Object(v.jsx)("button",{className:"bg-white rounded-md shadow-lg p-4 text-center my-4 dark:bg-gray-800 dark:text-gray-200 ",children:"\u5df2\u5173\u6ce8"})]})]}),Object(v.jsxs)("div",{className:"flex text-gray-600 p-4",children:[Object(v.jsx)("div",{className:"w-9/12",children:Object(v.jsx)(F,{username:r})}),Object(v.jsx)("div",{className:"w-3/12 ml-4 space-y-8",children:Object(v.jsx)(T,{user:n})})]})]})})}n(81);function ne(){var e=Object(c.useContext)(w).setUser,t=Object(c.useRef)(),n=Object(c.useRef)(),s=Object(R.g)(),r=function(c){null===c||void 0===c||c.preventDefault(),function(){var c=Object(l.a)(o.a.mark((function c(){var r,a;return o.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,x.post("auth/login",{email:t.current.value,password:n.current.value});case 2:r=c.sent,a=r.data,b.set("token",a.token),b.set("user",a.user),e(a.user),s.push("/home/share");case 8:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}()()};Object(c.useEffect)((function(){var e=function(e){13===e.keyCode&&r()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}));return Object(v.jsxs)("div",{className:"mx-auto bg-gradient-to-r from-purple-400 via-pink-500  text-white flex flex-col justify-center space-y-6 h-screen",children:[Object(v.jsx)(j.a,{position:"top-center",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),Object(v.jsxs)("div",{className:"flex flex-col h-screen justify-center items-center space-y-10",children:[Object(v.jsxs)("div",{className:"w-full  md:w-1/2 flex justify-center items-center flex-col space-y-4 ",children:[Object(v.jsx)("h2",{className:"text-6xl font-bold",children:"Fujix"}),Object(v.jsx)("span",{children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(v.jsx)("div",{className:"w-full md:w-2/3  lg:w-1/2  flex justify-center items-center ",children:Object(v.jsxs)("form",{onSubmit:r,className:"w-full m-4  md:w-1/2 flex bg-white p-4 flex-col justify-center items-center space-y-4  rounded-md shadow-xl ",children:[Object(v.jsx)("input",{placeholder:"\u90ae\u7bb1",type:"email",required:!0,ref:t,value:"shaodeyu@gmail.com",className:"w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400"}),Object(v.jsx)("input",{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",type:"password",required:!0,minLength:"6",value:123456,className:"w-full shadow-lg  p-2 rounded-md outline-none border-1 text-gray-600 focus:ring-2 focus:ring-blue-400",ref:n}),Object(v.jsx)("button",{className:"w-full shadow-lg bg-blue-400 p-2   rounded-md text-white my-8",children:"\u767b\u9646"}),Object(v.jsx)("span",{className:"text-gray-400 text-sm",children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"}),Object(v.jsx)("button",{onClick:function(){s.push("/register")},className:"w-full  shadow-lg bg-pink-400  p-2 text-white rounded-md",children:"\u521b\u5efa\u65b0\u8d26\u53f7"})]})})]})]})}function ce(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useRef)(),s=Object(c.useRef)(),r=Object(R.g)();return Object(v.jsx)("div",{className:"mx-auto bg-gradient-to-r from-purple-400 via-pink-500 text-white flex flex-col justify-center space-y-6 h-screen",children:Object(v.jsxs)("div",{className:"flex flex-col h-screen justify-center items-center space-y-10",children:[Object(v.jsxs)("div",{className:"w-full  md:w-1/2 flex justify-center items-center flex-col space-y-4 ",children:[Object(v.jsx)("h2",{className:"text-6xl font-bold",children:"Fujix"}),Object(v.jsx)("span",{children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(v.jsx)("div",{className:"w-full md:w-2/3  lg:w-1/2  flex justify-center items-center ",children:Object(v.jsxs)("form",{onSubmit:function(c){(c.preventDefault(),e.current.value===n.current.value)?(function(){var n=Object(l.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.post("auth/register",{username:t.current.value,password:e.current.value,email:s.current.value});case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),console.log(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})));return function(){return n.apply(this,arguments)}}()(),r.push("/login")):alert("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u540c")},className:"w-full m-4  md:w-1/2 flex bg-white p-4 flex-col justify-center items-center space-y-4  rounded-md shadow-xl ",children:[Object(v.jsx)("input",{placeholder:"\u7528\u6237\u540d",ref:t,required:!0,className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600"}),Object(v.jsx)("input",{placeholder:"\u90ae\u7bb1",ref:s,required:!0,className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600",type:"email"}),Object(v.jsx)("input",{placeholder:"\u5bc6\u7801",ref:e,type:"password",minLength:"6",required:!0,className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600"}),Object(v.jsx)("input",{placeholder:"\u518d\u6b21\u786e\u8ba4\u5bc6\u7801",ref:n,type:"password",required:!0,className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400  p-2 rounded-md outline-none  focus:border-blue-400 border-1 text-gray-600"}),Object(v.jsx)("button",{type:"submit",className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400  bg-blue-400 p-2   rounded-md text-white my-8",children:"\u6ce8\u518c"}),Object(v.jsx)("button",{onClick:function(){r.push("/login")},className:"w-full shadow-lg focus:ring-2 focus:ring-blue-400 bg-pink-400  p-2 text-white rounded-md",children:"\u767b\u9646"})]})})]})})}var se=n(25),re=n(23);function ae(){var e=Object(c.useContext)(w).user,t=Object(c.useState)(null),n=Object(i.a)(t,2),s=n[0],r=n[1],a=Object(c.useState)({}),u=Object(i.a)(a,2),d=u[0],j=u[1],b=d.username,f=d.city,m=d.from,p=d.desc;Object(c.useEffect)((function(){(function(){var t=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.get("users/".concat(e._id));case 2:n=t.sent,j(n.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e,j]);var h=function(t){var n=Object(se.a)({userId:null===e||void 0===e?void 0:e._id},t);(function(){var t=Object(l.a)(o.a.mark((function t(){var c,r,a,l;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!s){t.next=11;break}return c=new FormData,r=Date.now()+s.name,c.append("fileName",r),c.append("file",s),t.next=8,x.post("/upload",c);case 8:a=t.sent,l=a.data,n.profilePicture=l;case 11:return t.next=13,x.put("users/".concat(e._id),n);case 13:alert("\u4fdd\u5b58\u6210\u529f"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(){return t.apply(this,arguments)}})()()},O=function(){return Object(v.jsx)("div",{className:"mx-auto w-full bg-white text-gray-400  shadow-lg flex flex-col justify-center space-y-6 px-80 mb-10 py-20 dark:bg-gray-800 dark:text-gray-200 rounded-md",children:Object(v.jsxs)("div",{className:"space-y-4",children:[Object(v.jsxs)("h2",{className:"mb-4 flex items-center",children:[Object(v.jsx)(B.a,{fontSize:"large"}),Object(v.jsx)("span",{className:"font-bold pl-4 text-2xl",children:"\u8bbe\u7f6e"})]}),Object(v.jsxs)("label",{htmlFor:"file",children:[s?Object(v.jsx)("img",{alt:"",className:"",src:URL.createObjectURL(s)}):Object(v.jsx)("img",{src:d.profilePicture||"https://fujix.oss-cn-shenzhen.aliyuncs.com/noCover.png",alt:"",className:"w-32 h-32 rounded-lg object-cover shadow-lg"}),Object(v.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return r(e.target.files[0])}})]}),Object(v.jsx)(re.c,{initialValues:{username:b,city:f,from:m,desc:p},onSubmit:h,children:Object(v.jsxs)(re.b,{className:"flex flex-col space-y-4",children:[Object(v.jsx)("label",{htmlFor:"username",children:"\u7528\u6237\u540d\u5b57"}),Object(v.jsx)(re.a,{id:"username",name:"username",autoComplete:"off",className:"w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400"}),Object(v.jsx)("label",{htmlFor:"desc",children:"\u7b80\u4ecb"}),Object(v.jsx)(re.a,{id:"desc",name:"desc",autoComplete:"off",className:"w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400"}),Object(v.jsx)("label",{htmlFor:"city",children:"\u57ce\u5e02"}),Object(v.jsx)(re.a,{id:"city",name:"city",autoComplete:"off",className:"w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400"}),Object(v.jsx)("label",{htmlFor:"from",children:"\u5bb6\u4e61"}),Object(v.jsx)(re.a,{id:"from",name:"from",autoComplete:"off",className:"w-full shadow-lg p-2 rounded-md outline-none  border-1 text-gray-600 focus:ring-2 focus:ring-blue-400"}),Object(v.jsx)("p",{}),Object(v.jsx)("button",{variant:"contained",color:"primary",type:"submit",className:"w-full shadow-lg bg-pink-400  mt-8 p-2 text-white rounded-md dark:bg-blue-400",children:"\u4fdd\u5b58\u8bbe\u7f6e"})]})})]})})};return Object(v.jsx)(V,{children:Object(v.jsx)(O,{})})}function oe(){return Object(v.jsx)("div",{children:Object(v.jsx)("h1",{children:"404"})})}var le=n(51),ie=["isAuth","component"];function ue(e){var t=e.isAuth,n=e.component,c=Object(le.a)(e,ie);return Object(v.jsx)(R.b,Object(se.a)(Object(se.a)({},c),{},{render:function(e){return t?Object(v.jsx)(n,Object(se.a)({},e)):Object(v.jsx)(R.a,{to:"/login"})}}))}var de=function(){var e=Object(c.useContext)(w).user;return Object(v.jsx)(O.a,{children:Object(v.jsxs)(R.d,{children:[Object(v.jsx)(ue,{path:"/home/",component:ee,isAuth:e}),Object(v.jsx)(R.b,{path:"/login",component:ne}),Object(v.jsx)(ue,{path:"/register",component:ce,isAuth:e}),Object(v.jsx)(R.b,{path:"/profile/:username",component:te}),Object(v.jsx)(ue,{path:"/setting",component:ae,isAuth:e}),Object(v.jsx)(R.a,{path:"/",to:"/home/"}),Object(v.jsx)(R.b,{path:"*",component:oe})]})})};n(82),n(83);r.a.render(Object(v.jsx)(y,{children:Object(v.jsx)(de,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.212d54e2.chunk.js.map