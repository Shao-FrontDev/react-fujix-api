(this["webpackJsonpreact-sm"]=this["webpackJsonpreact-sm"]||[]).push([[0],{100:function(e,t,s){},101:function(e,t,s){},102:function(e,t,s){},103:function(e,t,s){},104:function(e,t,s){},105:function(e,t,s){"use strict";s.r(t);var c=s(0),a=s(28),n=s.n(a),r=(s(66),s(119)),i=s(120),l=s(121),o=s(8),u=s(4),j={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},remove:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()}},d=function(e,t){switch(t.type){case"LOGIN_START":var s={user:null,isFetching:!0,error:!1};return j.set("authData",s),s;case"LOGIN_SUCCESS":var c={user:t.payload,isFetching:!1,error:!1};return j.set("authData",c),c;case"UPDATE_USER":var a={user:t.payload,isFetching:!1,error:!1};return j.set("authData",a),a;case"LOGIN_FAILURE":var n={user:null,isFetching:!1,error:t.error};return j.set("authData",n),n;default:return e}},b=s(1),p=j.get("authData")?j.get("authData"):{user:null,isFecthing:!1,error:!1},m=Object(c.createContext)(p),h=function(e){var t=e.children,s=Object(c.useReducer)(d,p),a=Object(u.a)(s,2),n=a[0],r=a[1];return Object(b.jsx)(m.Provider,{value:{user:n.user,isFetching:n.isFetching,error:n.error,dispatch:r},children:t})};function O(){var e=Object(c.useContext)(m).user;return Object(b.jsxs)("div",{className:"sidebar",children:[Object(b.jsx)("h3",{className:"home",children:"\u9996\u9875"}),Object(b.jsx)("div",{className:"sidebarWrapper",children:Object(b.jsxs)("ul",{className:"sidebarList",children:[Object(b.jsx)(o.b,{to:"/",children:Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(r.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u5168\u90e8\u5173\u6ce8"})]})}),Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(i.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u7279\u522b\u5173\u6ce8"})]}),Object(b.jsx)(o.b,{to:"?userId=".concat(null===e||void 0===e?void 0:e._id),children:Object(b.jsxs)("li",{className:"sidebarListItem",children:[Object(b.jsx)(l.a,{className:"sidebarIcon"}),Object(b.jsx)("span",{className:"sidebarListItemText",children:"\u597d\u53cb\u5708"})]})})]})})]})}var x=s(3),f=s.n(x),v=s(6),g=s(54),N=s.n(g),I=function(){return N.a.create({baseURL:"http://localhost:8800/api/"})},w=(s(91),s(122));s(92);function y(e){var t=e.username,s=Object(c.useRef)(""),a=Object(c.useState)(null),n=Object(u.a)(a,2),r=n[0],i=n[1],l=Object(c.useContext)(m).user,o=Object(c.useState)(!0),j=Object(u.a)(o,2),d=(j[0],j[1]),p=function(e){return(e=e||"").replace(/(\n\r|\r\n|\r|\n)/g,"<br/>")},h=function(){var e=Object(v.a)(f.a.mark((function e(t){var c,a,n,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={userId:l._id,desc:p(s.current.value)},!r){e.next=18;break}return a=new FormData,n=Date.now()+r.name,a.append("fileName",n),a.append("file",r),e.prev=7,e.next=10,I().post("/upload",a);case 10:i=e.sent,o=i.data,c.img=o,console.log("update"),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(7);case 18:return e.prev=18,e.next=21,I().post("/posts",c);case 21:window.location.reload(),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(18),console.log(e.t1);case 27:case"end":return e.stop()}}),e,null,[[7,16],[18,24]])})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=function(){d(!0)};document.addEventListener("click",e);var t=function(){var e=Object(v.a)(f.a.mark((function e(){var t,c,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={userId:l._id,desc:p(s.current.value)},!r){e.next=14;break}return c=new FormData,a=Date.now()+r.name,c.append("fileName",a),c.append("file",r),t.img=a,e.prev=7,e.next=10,I().post("/upload",c);case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(7);case 14:return e.prev=14,e.next=17,I().post("/posts",t);case 17:window.location.reload(),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(14),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[7,12],[14,20]])})));return function(){return e.apply(this,arguments)}}(),c=function(e){13===e.keyCode&&e.ctrlKey&&t()};return document.addEventListener("keydown",c),function(){document.removeEventListener("keydown",c),document.removeEventListener("click",e)}}),[r,l]);var O=function(){return Object(b.jsx)("div",{className:"share",children:Object(b.jsxs)("div",{className:"shareWrapper",children:[Object(b.jsxs)("div",{className:"shareTop",children:[Object(b.jsx)("img",{src:"",alt:""}),Object(b.jsx)("textarea",{type:"text",placeholder:"\u6709\u4ec0\u4e48\u6709\u8da3\u7684\u4e8b\u60c5\u5206\u4eab\u7ed9\u5927\u5bb6?",className:"shareInput",ref:s})]}),Object(b.jsx)("hr",{className:"shareHr"}),r&&Object(b.jsx)("div",{className:"shareImageContainer",children:Object(b.jsx)("img",{alt:"",className:"shareImg",src:URL.createObjectURL(r)})}),Object(b.jsxs)("form",{className:"shareBottom",onSubmit:h,children:[Object(b.jsx)("div",{className:"shareOptions",children:Object(b.jsx)("div",{className:"shareOption",children:Object(b.jsxs)("label",{htmlFor:"file",className:"shareOptionText",children:[Object(b.jsx)(w.a,{htmlColor:"tomato",className:"shareIcon"}),Object(b.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return i(e.target.files[0])}})]})})}),Object(b.jsx)("button",{className:"shareButton",type:"submit",children:"\u53d1\u9001"})]})]})})};return void 0===t||t===(null===l||void 0===l?void 0:l.username)?Object(b.jsx)(O,{}):null}var k=s(123),C=s(57);s(93);function _(e){var t=e.post,s=Object(c.useState)(t.likes.length),a=Object(u.a)(s,2),n=a[0],r=a[1],i=Object(c.useState)(!1),l=Object(u.a)(i,2),j=l[0],d=l[1],p=Object(c.useState)(!1),h=Object(u.a)(p,2),O=h[0],x=h[1],g=Object(c.useState)({}),N=Object(u.a)(g,2),w=N[0],y=N[1],_=Object(c.useContext)(m).user;Object(c.useEffect)((function(){var e=function(){x(!1)};return document.addEventListener("click",e),function(){var e=Object(v.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I().get("/users/?userId=".concat(t.userId));case 2:s=e.sent,y(s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){document.removeEventListener("click",e)}}),[t.userId,x,O]);return Object(b.jsxs)("div",{className:"post",children:[Object(b.jsx)("div",{className:["postPop",O?"postPopShow":""].join(" "),children:Object(b.jsxs)("div",{className:"selected",children:[Object(b.jsx)("div",{onClick:function(){(function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userId!==_._id){e.next=5;break}return e.next=3,I().delete("posts/"+t._id,{data:{userId:_._id}});case 3:e.next=6;break;case 5:alert("\u4f60\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u535a\u5ba2");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),window.location.reload()},className:"selected__item",children:"\u5220\u9664"}),Object(b.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===_||void 0===_?void 0:_._id)===t.userId){e.next=6;break}return e.next=3,I().put("users/".concat(t.userId,"/follow"),{userId:null===_||void 0===_?void 0:_._id});case 3:alert("\u5173\u6ce8\u6210\u529f"),e.next=7;break;case 6:alert("\u4f60\u4e0d\u80fd\u5173\u6ce8\u81ea\u5df1");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u5173\u6ce8"}),Object(b.jsx)("div",{className:"selected__item",children:"\u7279\u522b\u5173\u6ce8"}),Object(b.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(v.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_._id===t.userId){e.next=7;break}return e.next=3,I().put("users/".concat(t.userId,"/unfollow"),{userId:_._id});case 3:alert("\u53d6\u6d88\u5173\u6ce8\u6210\u529f"),window.location.reload(),e.next=8;break;case 7:alert("\u4f60\u4e0d\u80fd\u53d6\u6d88\u5173\u6ce8\u81ea\u5df1");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u53d6\u6d88\u5173\u6ce8"})]})}),Object(b.jsxs)("div",{className:"postWrapper",children:[Object(b.jsxs)("div",{className:"postTop",children:[Object(b.jsxs)("div",{className:"postTopLeft",children:[Object(b.jsx)(o.b,{to:"/profile/".concat(w.username),children:Object(b.jsx)("img",{className:"postProfileImg",src:w.profilePicture||"http://localhost:8800/images/person/noAvatar.png",alt:""})}),Object(b.jsx)("span",{className:"postUsername",children:w.username}),Object(b.jsx)("span",{className:"postDate",children:Object(C.a)(t.createdAt,"zh_CN")})]}),Object(b.jsx)("div",{className:"postTopRight",children:Object(b.jsx)(k.a,{onClick:function(e){e.nativeEvent.stopImmediatePropagation(),x(!O)}})})]}),Object(b.jsxs)("div",{className:"postCenter",children:[Object(b.jsx)("span",{className:"postText",dangerouslySetInnerHTML:{__html:t.desc}}),Object(b.jsx)("img",{src:t.img,alt:"",className:"postImg"})]}),Object(b.jsxs)("div",{className:"postBottom",children:[Object(b.jsxs)("div",{className:"postBottomLeft",children:[Object(b.jsx)("img",{src:"/assets/like.png",alt:"",className:"likeIcon",onClick:function(){r(j?n-1:n+1),d(!j)}}),Object(b.jsx)("span",{className:"postLikeCounter",children:n})]}),Object(b.jsx)("div",{className:"postBottomRight",children:Object(b.jsxs)("span",{className:"postCommentText",children:[t.comment," \u8bc4\u8bba"]})})]})]})]})}var L=s(7);function S(e){var t=e.username,s=Object(c.useState)([]),a=Object(u.a)(s,2),n=a[0],r=a[1],i=Object(c.useContext)(m).user;Object(L.h)();return Object(c.useEffect)((function(){(function(){var e=Object(v.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,I().get("posts/profile/"+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,I().get("posts/timeline/".concat(null===i||void 0===i?void 0:i._id));case 8:e.t0=e.sent;case 9:s=e.t0,r(s.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t,i]),Object(b.jsx)("div",{className:"center",children:Object(b.jsxs)("div",{className:"centerWrapper",children:[Object(b.jsx)(y,{username:t}),n.map((function(e){return Object(b.jsx)(_,{post:e},e._id)}))]})})}s(94),s(95);function F(e){var t=e.user;return Object(b.jsx)(o.b,{to:"/profile/".concat(t.username),children:Object(b.jsxs)("li",{className:"rightbarFriend",children:[Object(b.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(b.jsx)("img",{src:t.profilePicture?t.profilePicture:"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"rightbarProfileImg"}),Object(b.jsx)("span",{className:"rightbarOnline"})]}),Object(b.jsx)("span",{className:"rightbarUsername",children:t.username})]})})}s(96);var R=s(124),E=s(125),D=function(e){var t=Object(c.useState)({}),s=Object(u.a)(t,2),a=s[0],n=s[1];return Object(c.useEffect)((function(){(function(){var t=Object(v.a)(f.a.mark((function t(){var s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I().get(e);case 2:s=t.sent,n(s.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),[a]};function T(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),s=t[0],a=(t[1],Object(c.useContext)(m).user),n="users/".concat(a._id),r=D(n),i=Object(u.a)(r,1)[0];return Object(b.jsxs)("div",{className:"box",children:[Object(b.jsxs)("div",{className:"header",children:[Object(b.jsx)(o.b,{to:i?"/profile/".concat(i.username):"/",children:Object(b.jsx)("img",{src:i.profilePicture||"http://localhost:8800/images/person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(b.jsx)("div",{children:i.username}),s?Object(b.jsx)("span",{className:"dark",children:Object(b.jsx)(R.a,{})}):Object(b.jsx)("span",{className:"light",children:Object(b.jsx)(E.a,{})})]}),Object(b.jsx)(o.b,{to:"/portfolio",children:"\u6211\u7684\u4f5c\u54c1\u96c6"}),Object(b.jsx)(o.b,{to:"/filter",children:"\u6211\u7684\u6ee4\u955c"})]})}function A(e){var t=e.user,s=Object(c.useState)([]),a=Object(u.a)(s,2),n=a[0],r=a[1],i=Object(c.useContext)(m).user,l=Object(c.useState)([]),j=Object(u.a)(l,2),d=j[0],p=j[1];Object(c.useEffect)((function(){(function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I().get("users/friends/".concat(null===i||void 0===i?void 0:i._id));case 2:t=e.sent,r(null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[i]),Object(c.useEffect)((function(){(function(){var e=Object(v.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I().get("users/circle/".concat(null===t||void 0===t?void 0:t._id));case 2:s=e.sent,p(null===s||void 0===s?void 0:s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var h=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(T,{}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u6211\u7684\u5173\u6ce8"}),Object(b.jsx)("ul",{className:"rightbarFriendList",children:n&&n.map((function(e){return Object(b.jsx)(F,{user:e},null===e||void 0===e?void 0:e._id)}))}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u63a8\u8350\u5173\u6ce8"})]})},O=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u7b80\u4ecb"}),Object(b.jsxs)("div",{className:"rightbarInfo",children:[Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u5c45\u4f4f\u5730:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.city})]}),Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u5bb6\u4e61:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.from})]}),Object(b.jsxs)("div",{className:"rightbarInfoItem",children:[Object(b.jsx)("span",{className:"rightbarInfoKey",children:"\u804c\u4e1a:"}),Object(b.jsx)("span",{className:"rightbarInfoValue",children:t.relationship})]})]}),Object(b.jsx)("h4",{className:"rightbarTitle",children:"\u597d\u53cb\u5708"}),Object(b.jsx)("div",{className:"rightbarFollowings",children:d&&d.map((function(e){return Object(b.jsx)(o.b,{to:"/profile/".concat(e.username),children:Object(b.jsxs)("div",{className:"rightbarFollowing",children:[Object(b.jsx)("img",{src:e.profilePicture?e.profilePicture:"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(b.jsx)("span",{className:"rightbarFollowingName",children:null===e||void 0===e?void 0:e.username})]})},null===e||void 0===e?void 0:e._id)}))})]})};return Object(b.jsx)("div",{className:"rightbar",children:Object(b.jsx)("div",{className:"rightbarWrapper",children:t?Object(b.jsx)(O,{}):Object(b.jsx)(h,{})})})}s(97);var P=s(126),B=s(127),U=s(128);function W(){var e=Object(c.useContext)(m).user,t="users/".concat(e._id),s=D(t),a=Object(u.a)(s,1)[0];return Object(b.jsxs)("div",{className:"topbarContainer",children:[Object(b.jsx)("div",{className:"topbarLeft",children:Object(b.jsx)(o.b,{to:"/",children:Object(b.jsx)("span",{className:"logo",children:"Fujix"})})}),Object(b.jsx)("div",{className:"topbarCenter",children:Object(b.jsxs)("div",{className:"searchbar",children:[Object(b.jsx)(P.a,{className:"searchIcon"}),Object(b.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u597d\u53cb\u6216\u8005\u6709\u8da3\u7684\u4e8b\u60c5",className:"searchInput"})]})}),Object(b.jsxs)("div",{className:"topbarRight",children:[Object(b.jsx)(o.b,{to:a?"/profile/".concat(a.username):"/",children:Object(b.jsx)("img",{src:a.profilePicture||"http://localhost:8800/images/person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(b.jsx)(o.b,{to:"/",children:Object(b.jsx)("span",{className:"home",children:Object(b.jsx)(B.a,{})})}),Object(b.jsx)(o.b,{to:"/setting",children:Object(b.jsx)("span",{className:"setting",children:Object(b.jsx)(U.a,{})})}),Object(b.jsx)("span",{className:"logout",onClick:function(){j.clear(),window.location.reload()},children:"\u767b\u51fa"})]})]})}s(98);function q(e){var t=e.children;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(W,{}),Object(b.jsx)("div",{className:"homeContainer",children:t})]})}function G(){return Object(b.jsxs)(q,{children:[Object(b.jsx)(O,{}),Object(b.jsx)(S,{}),Object(b.jsx)(A,{home:!0})]})}s(99);function J(){var e="http://localhost:8800/images/",t=Object(c.useState)({}),s=Object(u.a)(t,2),a=s[0],n=s[1],r=Object(L.i)().username;return Object(c.useEffect)((function(){var e=function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I().get("/users?username=".concat(r));case 2:t=e.sent,n(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){e=null}}),[r]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(W,{}),Object(b.jsx)("div",{className:"profile",children:Object(b.jsxs)("div",{className:"profileRight",children:[Object(b.jsxs)("div",{className:"profileRightTop",children:[Object(b.jsxs)("div",{className:"profileCover",children:[Object(b.jsx)("img",{src:a.coverPicture||e+"person/noCover.png",alt:"",className:"profileCoverImg"}),Object(b.jsx)("label",{htmlFor:"file",children:Object(b.jsx)("img",{src:a.profilePicture||e+"person/noAvatar.png",alt:"",className:"profileUserImg"})})]}),Object(b.jsxs)("div",{className:"profileInfo",children:[Object(b.jsx)("div",{className:"profileInfoName",children:a.username}),Object(b.jsx)("div",{className:"profileInfoDesc",children:a.desc})]})]}),Object(b.jsxs)("div",{className:"profileRightBottom",children:[Object(b.jsx)(S,{username:r}),Object(b.jsx)(A,{user:a})]})]})})]})}var K=function(){var e=Object(v.a)(f.a.mark((function e(t,s){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOGIN_START"}),e.prev=1,e.next=4,I().post("auth/login",t);case 4:c=e.sent,s({type:"LOGIN_SUCCESS",payload:c.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),s({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,s){return e.apply(this,arguments)}}(),V=s(129);s(100);function z(){var e=Object(c.useContext)(m),t=e.isFetching,s=e.dispatch,a=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(L.g)(),i=function(e){null===e||void 0===e||e.preventDefault(),K({email:a.current.value,password:n.current.value},s),r.push("/")};Object(c.useEffect)((function(){var e=function(e){13===e.keyCode&&i()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}));return Object(b.jsx)("div",{className:"login",children:Object(b.jsxs)("div",{className:"loginWrapper",children:[Object(b.jsxs)("div",{className:"loginLeft",children:[Object(b.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(b.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(b.jsx)("div",{className:"loginRight",children:Object(b.jsxs)("form",{className:"loginBox",onSubmit:i,children:[Object(b.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",type:"email",required:!0,ref:a}),Object(b.jsx)("input",{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",className:"loginInput",type:"password",required:!0,minLength:"6",ref:n}),Object(b.jsx)("button",{className:"loginButton",children:t?Object(b.jsx)(V.a,{primary:"true"}):"\u767b\u9646"}),Object(b.jsx)("span",{className:"loginForgot",children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"}),Object(b.jsx)("button",{className:"loginRegisterButton",onClick:function(){r.push("/register")},children:"\u521b\u5efa\u65b0\u8d26\u53f7"})]})})]})})}s(101);function H(){var e=Object(c.useRef)(),t=Object(c.useRef)(),s=Object(c.useRef)(),a=Object(c.useRef)(),n=Object(L.g)();return Object(b.jsx)("div",{className:"login",children:Object(b.jsxs)("div",{className:"loginWrapper",children:[Object(b.jsxs)("div",{className:"loginLeft",children:[Object(b.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(b.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(b.jsx)("div",{className:"loginRight",children:Object(b.jsxs)("form",{className:"loginBox",onSubmit:function(c){(c.preventDefault(),e.current.value===s.current.value)?(function(){var s=Object(v.a)(f.a.mark((function s(){var c;return f.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,I().post("auth/register",{username:t.current.value,password:e.current.value,email:a.current.value});case 3:c=s.sent,console.log(c),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})));return function(){return s.apply(this,arguments)}}()(),n.push("/login")):alert("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u540c")},children:[Object(b.jsx)("input",{placeholder:"\u7528\u6237\u540d",className:"loginInput",ref:t,required:!0}),Object(b.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",ref:a,required:!0,type:"email"}),Object(b.jsx)("input",{placeholder:"\u5bc6\u7801",className:"loginInput",ref:e,type:"password",minLength:"6",required:!0}),Object(b.jsx)("input",{placeholder:"\u518d\u6b21\u786e\u8ba4\u5bc6\u7801",className:"loginInput",ref:s,type:"password",required:!0}),Object(b.jsx)("button",{className:"loginButton",type:"submit",children:"\u6ce8\u518c"}),Object(b.jsx)("button",{className:"loginRegisterButton",onClick:function(){n.push("/login")},children:"\u767b\u9646"})]})})]})})}var M=s(58),Q=s(27),X=(s(102),s(130));function Y(){var e=Object(c.useContext)(m).user,t=Object(c.useState)(null),s=Object(u.a)(t,2),a=s[0],n=s[1],r=Object(c.useState)({}),i=Object(u.a)(r,2),l=i[0],o=i[1],j=l.username,d=l.city,p=l.from,h=l.desc;Object(c.useEffect)((function(){(function(){var t=Object(v.a)(f.a.mark((function t(){var s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I().get("users/".concat(e._id));case 2:s=t.sent,o(s.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e,o]),console.log(l);var O=function(t){var s=Object(M.a)({userId:null===e||void 0===e?void 0:e._id},t);(function(){var t=Object(v.a)(f.a.mark((function t(){var c,n,r,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!a){t.next=11;break}return c=new FormData,n=Date.now()+a.name,c.append("fileName",n),c.append("file",a),t.next=8,I().post("/upload",c);case 8:r=t.sent,i=r.data,s.profilePicture=i;case 11:return t.next=13,I().put("users/".concat(e._id),s);case 13:alert("\u4fdd\u5b58\u6210\u529f"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(){return t.apply(this,arguments)}})()()},x=function(){return Object(b.jsx)("div",{className:"form",children:Object(b.jsxs)("div",{className:"formWrapper",children:[Object(b.jsxs)("h2",{className:"heading",children:[Object(b.jsx)(U.a,{fontSize:"large"}),"\u8bbe\u7f6e"]}),Object(b.jsxs)("label",{htmlFor:"file",children:[a?Object(b.jsx)("img",{alt:"",className:"userImg",src:URL.createObjectURL(a)}):Object(b.jsx)("img",{src:l.profilePicture||"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"userImg"}),Object(b.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return n(e.target.files[0])}})]}),Object(b.jsx)(Q.c,{initialValues:{username:j,city:d,from:p,desc:h},onSubmit:O,children:Object(b.jsxs)(Q.b,{className:"formBasic",children:[Object(b.jsx)("label",{htmlFor:"username",children:"\u7528\u6237\u540d\u5b57"}),Object(b.jsx)(Q.a,{id:"username",name:"username",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"desc",children:"\u7b80\u4ecb"}),Object(b.jsx)(Q.a,{id:"desc",name:"desc",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"city",children:"\u57ce\u5e02"}),Object(b.jsx)(Q.a,{id:"city",name:"city",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)("label",{htmlFor:"from",children:"\u5bb6\u4e61"}),Object(b.jsx)(Q.a,{id:"from",name:"from",autoComplete:"off",className:"fieldItem"}),Object(b.jsx)(X.a,{variant:"contained",color:"primary",type:"submit",children:"\u4fdd\u5b58\u8bbe\u7f6e"})]})})]})})};return Object(b.jsxs)(q,{children:[Object(b.jsx)("div",{className:"sidebar"}),Object(b.jsx)("div",{className:"center",children:Object(b.jsx)(x,{})}),Object(b.jsx)("div",{className:"rightbar",children:Object(b.jsx)(T,{})})]})}s(103);function Z(){var e=Object(c.useContext)(m).user,t=function(e){var t=Object(c.useState)([]),s=Object(u.a)(t,2),a=s[0],n=s[1];return Object(c.useEffect)((function(){!function(){var t=Object(v.a)(f.a.mark((function t(){var s,c,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I().get(e);case 3:c=t.sent,a=null===(s=c.data)||void 0===s?void 0:s.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),n(a.filter((function(e){return void 0!=e.img}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),a}("posts/portfolio/".concat(null===e||void 0===e?void 0:e._id));return Object(b.jsxs)(q,{children:[Object(b.jsx)("div",{className:"imageWrapper",children:t.map((function(e){return Object(b.jsx)("img",{src:e.img,alt:"",className:"portfolioImg"},e._id)}))}),Object(b.jsx)(A,{})]})}function $(){return Object(b.jsx)("div",{children:Object(b.jsx)("h1",{children:"404"})})}var ee=function(){var e=Object(c.useContext)(m).user;return Object(b.jsx)(o.a,{children:Object(b.jsxs)(L.d,{children:[Object(b.jsxs)(L.b,{path:"/",exact:!0,children:[e&&Object(b.jsx)(G,{}),!e&&Object(b.jsx)(L.a,{to:"/login"})]}),Object(b.jsxs)(L.b,{path:"/login",children:[e&&Object(b.jsx)(L.a,{to:"/"}),!e&&Object(b.jsx)(z,{})]}),Object(b.jsxs)(L.b,{path:"/portfolio",children:[e&&Object(b.jsx)(Z,{}),!e&&Object(b.jsx)(L.a,{to:"/"})]}),Object(b.jsx)(L.b,{path:"/register",children:Object(b.jsx)(H,{})}),Object(b.jsxs)(L.b,{path:"/profile/:username",children:[e&&Object(b.jsx)(J,{}),!e&&Object(b.jsx)(L.a,{to:"/login"})]}),Object(b.jsxs)(L.b,{path:"/setting",children:[e&&Object(b.jsx)(Y,{}),!e&&Object(b.jsx)(L.a,{to:"/login"})]}),Object(b.jsx)(L.b,{path:"*",children:Object(b.jsx)($,{})})]})})};s(104);n.a.render(Object(b.jsx)(h,{children:Object(b.jsx)(ee,{})}),document.getElementById("root"))},66:function(e,t,s){},91:function(e,t,s){},92:function(e,t,s){},93:function(e,t,s){},94:function(e,t,s){},95:function(e,t,s){},96:function(e,t,s){},97:function(e,t,s){},98:function(e,t,s){},99:function(e,t,s){}},[[105,1,2]]]);
//# sourceMappingURL=main.4c57cc5c.chunk.js.map