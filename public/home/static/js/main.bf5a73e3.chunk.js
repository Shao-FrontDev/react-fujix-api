(this["webpackJsonpreact-sm"]=this["webpackJsonpreact-sm"]||[]).push([[0],{101:function(e,t,s){},102:function(e,t,s){},103:function(e,t,s){},104:function(e,t,s){},105:function(e,t,s){},106:function(e,t,s){"use strict";s.r(t);var c=s(0),n=s(25),r=s.n(n),a=(s(66),s(121)),i=s(122),o=s(123),l=s(8),j=s(4),u={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},remove:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()}},d=s(1),b={user:null},p=Object(c.createContext)(b),m=function(e){var t=e.children,s=Object(c.useState)(u.get("user")||null),n=Object(j.a)(s,2),r=n[0],a=n[1];return Object(d.jsx)(p.Provider,{value:{user:r,setUser:a},children:t})};function O(){var e=Object(c.useContext)(p).user;return Object(d.jsxs)("div",{className:"sidebar",children:[Object(d.jsx)("h3",{className:"home",children:"\u9996\u9875"}),Object(d.jsx)("div",{className:"sidebarWrapper",children:Object(d.jsxs)("ul",{className:"sidebarList",children:[Object(d.jsx)(l.b,{to:"/",children:Object(d.jsxs)("li",{className:"sidebarListItem",children:[Object(d.jsx)(a.a,{className:"sidebarIcon"}),Object(d.jsx)("span",{className:"sidebarListItemText",children:"\u5168\u90e8\u5173\u6ce8"})]})}),Object(d.jsxs)("li",{className:"sidebarListItem",children:[Object(d.jsx)(i.a,{className:"sidebarIcon"}),Object(d.jsx)("span",{className:"sidebarListItemText",children:"\u7279\u522b\u5173\u6ce8"})]}),Object(d.jsx)(l.b,{to:"?userId=".concat(null===e||void 0===e?void 0:e._id),children:Object(d.jsxs)("li",{className:"sidebarListItem",children:[Object(d.jsx)(o.a,{className:"sidebarIcon"}),Object(d.jsx)("span",{className:"sidebarListItemText",children:"\u597d\u53cb\u5708"})]})})]})})]})}var h=s(3),f=s.n(h),x=s(5),v=s(55),g=s.n(v),N=s(34),I=g.a.create({baseURL:"/api"});I.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+u.get("token")||!1,e})),I.interceptors.response.use((function(e){return e}),(function(e){var t,s;return Object(N.b)(null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message),Promise.reject(e)}));var w=I,k=(s(91),s(124));s(92);function y(e){var t=e.username,s=Object(c.useRef)(""),n=Object(c.useState)(null),r=Object(j.a)(n,2),a=r[0],i=r[1],o=Object(c.useContext)(p).user,l=Object(c.useState)(!0),u=Object(j.a)(l,2),b=(u[0],u[1]),m=function(e){return(e=e||"").replace(/(\n\r|\r\n|\r|\n)/g,"<br/>")},O=function(){var e=Object(x.a)(f.a.mark((function e(t){var c,n,r,i,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c={userId:o._id,desc:m(s.current.value)},!a){e.next=17;break}return n=new FormData,r=Date.now()+a.name,n.append("fileName",r),n.append("file",a),e.prev=7,e.next=10,w.post("/upload",n);case 10:i=e.sent,l=i.data,c.img=l,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(7);case 17:return e.prev=17,e.next=20,w.post("/posts",c);case 20:window.location.reload(),e.next=25;break;case 23:e.prev=23,e.t1=e.catch(17);case 25:case"end":return e.stop()}}),e,null,[[7,15],[17,23]])})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=function(){b(!0)};document.addEventListener("click",e);var t=function(){var e=Object(x.a)(f.a.mark((function e(){var t,c,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={userId:o._id,desc:m(s.current.value)},!a){e.next=14;break}return c=new FormData,n=Date.now()+a.name,c.append("fileName",n),c.append("file",a),t.img=n,e.prev=7,e.next=10,w.post("/upload",c);case 10:e.next=14;break;case 12:e.prev=12,e.t0=e.catch(7);case 14:return e.prev=14,e.next=17,w.post("/posts",t);case 17:window.location.reload(),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(14),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[7,12],[14,20]])})));return function(){return e.apply(this,arguments)}}(),c=function(e){13===e.keyCode&&e.ctrlKey&&t()};return document.addEventListener("keydown",c),function(){document.removeEventListener("keydown",c),document.removeEventListener("click",e)}}),[a,o]);var h=function(){return Object(d.jsx)("div",{className:"share",children:Object(d.jsxs)("div",{className:"shareWrapper",children:[Object(d.jsxs)("div",{className:"shareTop",children:[Object(d.jsx)("img",{src:"",alt:""}),Object(d.jsx)("textarea",{type:"text",placeholder:"\u6709\u4ec0\u4e48\u6709\u8da3\u7684\u4e8b\u60c5\u5206\u4eab\u7ed9\u5927\u5bb6?",className:"shareInput",ref:s})]}),Object(d.jsx)("hr",{className:"shareHr"}),a&&Object(d.jsx)("div",{className:"shareImageContainer",children:Object(d.jsx)("img",{alt:"",className:"shareImg",src:URL.createObjectURL(a)})}),Object(d.jsxs)("form",{className:"shareBottom",onSubmit:O,children:[Object(d.jsx)("div",{className:"shareOptions",children:Object(d.jsx)("div",{className:"shareOption",children:Object(d.jsxs)("label",{htmlFor:"file",className:"shareOptionText",children:[Object(d.jsx)(k.a,{htmlColor:"tomato",className:"shareIcon"}),Object(d.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return i(e.target.files[0])}})]})})}),Object(d.jsx)("button",{className:"shareButton",type:"submit",children:"\u53d1\u9001"})]})]})})};return void 0===t||t===(null===o||void 0===o?void 0:o.username)?Object(d.jsx)(h,{}):null}var C=s(125),L=s(58);s(93);function _(e){var t=e.post,s=Object(c.useState)(t.likes.length),n=Object(j.a)(s,2),r=n[0],a=n[1],i=Object(c.useState)(!1),o=Object(j.a)(i,2),u=o[0],b=o[1],m=Object(c.useState)(!1),O=Object(j.a)(m,2),h=O[0],v=O[1],g=Object(c.useState)({}),N=Object(j.a)(g,2),I=N[0],k=N[1],y=Object(c.useContext)(p).user;Object(c.useEffect)((function(){var e=function(){v(!1)};return document.addEventListener("click",e),function(){var e=Object(x.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/users/?userId=".concat(t.userId));case 2:s=e.sent,k(s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){document.removeEventListener("click",e)}}),[t.userId,v,h]);return Object(d.jsxs)("div",{className:"post",children:[Object(d.jsx)("div",{className:["postPop",h?"postPopShow":""].join(" "),children:Object(d.jsxs)("div",{className:"selected",children:[Object(d.jsx)("div",{onClick:function(){(function(){var e=Object(x.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userId!==y._id){e.next=5;break}return e.next=3,w.delete("posts/"+t._id,{data:{userId:y._id}});case 3:e.next=6;break;case 5:alert("\u4f60\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u535a\u5ba2");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),window.location.reload()},className:"selected__item",children:"\u5220\u9664"}),Object(d.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(x.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===y||void 0===y?void 0:y._id)===t.userId){e.next=6;break}return e.next=3,w().put("users/".concat(t.userId,"/follow"),{userId:null===y||void 0===y?void 0:y._id});case 3:alert("\u5173\u6ce8\u6210\u529f"),e.next=7;break;case 6:alert("\u4f60\u4e0d\u80fd\u5173\u6ce8\u81ea\u5df1");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u5173\u6ce8"}),Object(d.jsx)("div",{className:"selected__item",children:"\u7279\u522b\u5173\u6ce8"}),Object(d.jsx)("div",{className:"selected__item",onClick:function(){(function(){var e=Object(x.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y._id===t.userId){e.next=7;break}return e.next=3,w.put("users/".concat(t.userId,"/unfollow"),{userId:y._id});case 3:alert("\u53d6\u6d88\u5173\u6ce8\u6210\u529f"),window.location.reload(),e.next=8;break;case 7:alert("\u4f60\u4e0d\u80fd\u53d6\u6d88\u5173\u6ce8\u81ea\u5df1");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()},children:"\u53d6\u6d88\u5173\u6ce8"})]})}),Object(d.jsxs)("div",{className:"postWrapper",children:[Object(d.jsxs)("div",{className:"postTop",children:[Object(d.jsxs)("div",{className:"postTopLeft",children:[Object(d.jsx)(l.b,{to:"/profile/".concat(I.username),children:Object(d.jsx)("img",{className:"postProfileImg",src:I.profilePicture||"http://localhost:8800/images/person/noAvatar.png",alt:""})}),Object(d.jsx)("span",{className:"postUsername",children:I.username}),Object(d.jsx)("span",{className:"postDate",children:Object(L.a)(t.createdAt,"zh_CN")})]}),Object(d.jsx)("div",{className:"postTopRight",children:Object(d.jsx)(C.a,{onClick:function(e){e.nativeEvent.stopImmediatePropagation(),v(!h)}})})]}),Object(d.jsxs)("div",{className:"postCenter",children:[Object(d.jsx)("span",{className:"postText",dangerouslySetInnerHTML:{__html:t.desc}}),Object(d.jsx)("img",{src:t.img,alt:"",className:"postImg"})]}),Object(d.jsxs)("div",{className:"postBottom",children:[Object(d.jsxs)("div",{className:"postBottomLeft",children:[Object(d.jsx)("img",{src:"/assets/like.png",alt:"",className:"likeIcon",onClick:function(){a(u?r-1:r+1),b(!u)}}),Object(d.jsx)("span",{className:"postLikeCounter",children:r})]}),Object(d.jsx)("div",{className:"postBottomRight",children:Object(d.jsxs)("span",{className:"postCommentText",children:[t.comment," \u8bc4\u8bba"]})})]})]})]})}var S=s(6);function F(e){var t=e.username,s=Object(c.useState)([]),n=Object(j.a)(s,2),r=n[0],a=n[1];Object(S.h)();return Object(c.useEffect)((function(){(function(){var e=Object(x.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,w.get("posts/profile/"+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,w.get("posts/timeline/now");case 8:e.t0=e.sent;case 9:s=e.t0,a(s.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(d.jsx)("div",{className:"center",children:Object(d.jsxs)("div",{className:"centerWrapper",children:[Object(d.jsx)(y,{username:t}),r.map((function(e){return Object(d.jsx)(_,{post:e},e._id)}))]})})}s(94),s(95);function R(e){var t=e.user;return Object(d.jsx)(l.b,{to:"/profile/".concat(t.username),children:Object(d.jsxs)("li",{className:"rightbarFriend",children:[Object(d.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(d.jsx)("img",{src:t.profilePicture?t.profilePicture:"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"rightbarProfileImg"}),Object(d.jsx)("span",{className:"rightbarOnline"})]}),Object(d.jsx)("span",{className:"rightbarUsername",children:t.username})]})})}s(96);var E=s(126),P=s(127),D=function(e){var t=Object(c.useState)({}),s=Object(j.a)(t,2),n=s[0],r=s[1];return Object(c.useEffect)((function(){(function(){var t=Object(x.a)(f.a.mark((function t(){var s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get(e);case 2:s=t.sent,r(s.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),[n]};function T(){var e="http://localhost:8800/images/",t=Object(c.useState)(!1),s=Object(j.a)(t,2),n=s[0],r=(s[1],Object(c.useContext)(p).user),a=r?"users/".concat(null===r||void 0===r?void 0:r._id):"",i=D(a),o=Object(j.a)(i,1)[0];return Object(c.useMemo)((function(){return Object(d.jsxs)("div",{className:"box",children:[Object(d.jsxs)("div",{className:"header",children:[Object(d.jsx)(l.b,{to:o?"/profile/".concat(o.username):"/",children:Object(d.jsx)("img",{src:(null===o||void 0===o?void 0:o.profilePicture)||e+"person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(d.jsx)("div",{children:null===o||void 0===o?void 0:o.username}),n?Object(d.jsx)("span",{className:"dark",children:Object(d.jsx)(E.a,{})}):Object(d.jsx)("span",{className:"light",children:Object(d.jsx)(P.a,{})})]}),Object(d.jsx)(l.b,{to:"/portfolio",children:"\u6211\u7684\u4f5c\u54c1\u96c6"}),Object(d.jsx)(l.b,{to:"/filter",children:"\u6211\u7684\u6ee4\u955c"})]})}),[o,e,n])}function B(e){var t=e.user,s=Object(c.useState)([]),n=Object(j.a)(s,2),r=n[0],a=n[1],i=Object(c.useContext)(p).user,o=Object(c.useState)([]),u=Object(j.a)(o,2),b=u[0],m=u[1];Object(c.useEffect)((function(){(function(){var e=Object(x.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("users/friends/".concat(null===i||void 0===i?void 0:i._id));case 2:t=e.sent,a(null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[i]),Object(c.useEffect)((function(){(function(){var e=Object(x.a)(f.a.mark((function e(){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("users/circle/".concat(null===t||void 0===t?void 0:t._id));case 2:s=e.sent,m(null===s||void 0===s?void 0:s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var O=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(T,{}),Object(d.jsx)("h4",{className:"rightbarTitle",children:"\u6211\u7684\u5173\u6ce8"}),Object(d.jsx)("ul",{className:"rightbarFriendList",children:r&&r.map((function(e){return Object(d.jsx)(R,{user:e},null===e||void 0===e?void 0:e._id)}))}),Object(d.jsx)("h4",{className:"rightbarTitle",children:"\u63a8\u8350\u5173\u6ce8"})]})},h=function(){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h4",{className:"rightbarTitle",children:"\u7b80\u4ecb"}),Object(d.jsxs)("div",{className:"rightbarInfo",children:[Object(d.jsxs)("div",{className:"rightbarInfoItem",children:[Object(d.jsx)("span",{className:"rightbarInfoKey",children:"\u5c45\u4f4f\u5730:"}),Object(d.jsx)("span",{className:"rightbarInfoValue",children:t.city})]}),Object(d.jsxs)("div",{className:"rightbarInfoItem",children:[Object(d.jsx)("span",{className:"rightbarInfoKey",children:"\u5bb6\u4e61:"}),Object(d.jsx)("span",{className:"rightbarInfoValue",children:t.from})]}),Object(d.jsxs)("div",{className:"rightbarInfoItem",children:[Object(d.jsx)("span",{className:"rightbarInfoKey",children:"\u804c\u4e1a:"}),Object(d.jsx)("span",{className:"rightbarInfoValue",children:t.relationship})]})]}),Object(d.jsx)("h4",{className:"rightbarTitle",children:"\u597d\u53cb\u5708"}),Object(d.jsx)("div",{className:"rightbarFollowings",children:b&&b.map((function(e){return Object(d.jsx)(l.b,{to:"/profile/".concat(e.username),children:Object(d.jsxs)("div",{className:"rightbarFollowing",children:[Object(d.jsx)("img",{src:e.profilePicture?e.profilePicture:"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(d.jsx)("span",{className:"rightbarFollowingName",children:null===e||void 0===e?void 0:e.username})]})},null===e||void 0===e?void 0:e._id)}))})]})};return Object(d.jsx)("div",{className:"rightbar",children:Object(d.jsx)("div",{className:"rightbarWrapper",children:t?Object(d.jsx)(h,{}):Object(d.jsx)(O,{})})})}s(97);var A=s(128),U=s(129),W=s(130);function q(){var e=Object(c.useContext)(p).user,t=(Object(S.g)(),e?"users/".concat(e._id):""),s=D(t),n=Object(j.a)(s,1)[0];return Object(d.jsxs)("div",{className:"topbarContainer",children:[Object(d.jsx)("div",{className:"topbarLeft",children:Object(d.jsx)(l.b,{to:"/",children:Object(d.jsx)("span",{className:"logo",children:"Fujix"})})}),Object(d.jsx)("div",{className:"topbarCenter",children:Object(d.jsxs)("div",{className:"searchbar",children:[Object(d.jsx)(A.a,{className:"searchIcon"}),Object(d.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u597d\u53cb\u6216\u8005\u6709\u8da3\u7684\u4e8b\u60c5",className:"searchInput"})]})}),Object(d.jsxs)("div",{className:"topbarRight",children:[Object(d.jsx)(l.b,{to:n?"/profile/".concat(n.username):"/",children:Object(d.jsx)("img",{src:n.profilePicture||"http://localhost:8800/images/person/noAvatar.png",className:"userAvatar",alt:"avatart"})}),Object(d.jsx)(l.b,{to:"/",children:Object(d.jsx)("span",{className:"home",children:Object(d.jsx)(U.a,{})})}),Object(d.jsx)(l.b,{to:"/setting",children:Object(d.jsx)("span",{className:"setting",children:Object(d.jsx)(W.a,{})})}),Object(d.jsx)("span",{className:"logout",onClick:function(){u.clear(),window.location.reload()},children:"\u767b\u51fa"})]})]})}s(98);function J(e){var t=e.children;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(q,{}),Object(d.jsx)("div",{className:"homeContainer",children:t})]})}function K(){return Object(d.jsxs)(J,{children:[Object(d.jsx)(O,{}),Object(d.jsx)(F,{}),Object(d.jsx)(B,{home:!0})]})}s(99);function V(){var e="http://localhost:8800/images/",t=Object(c.useState)({}),s=Object(j.a)(t,2),n=s[0],r=s[1],a=Object(S.i)().username;return Object(c.useEffect)((function(){var e=function(){var e=Object(x.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.get("/users?username=".concat(a));case 2:t=e.sent,r(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){e=null}}),[a]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(q,{}),Object(d.jsx)("div",{className:"profile",children:Object(d.jsxs)("div",{className:"profileRight",children:[Object(d.jsxs)("div",{className:"profileRightTop",children:[Object(d.jsxs)("div",{className:"profileCover",children:[Object(d.jsx)("img",{src:n.coverPicture||e+"person/noCover.png",alt:"",className:"profileCoverImg"}),Object(d.jsx)("label",{htmlFor:"file",children:Object(d.jsx)("img",{src:n.profilePicture||e+"person/noAvatar.png",alt:"",className:"profileUserImg"})})]}),Object(d.jsxs)("div",{className:"profileInfo",children:[Object(d.jsx)("div",{className:"profileInfoName",children:n.username}),Object(d.jsx)("div",{className:"profileInfoDesc",children:n.desc})]})]}),Object(d.jsxs)("div",{className:"profileRightBottom",children:[Object(d.jsx)(F,{username:a}),Object(d.jsx)(B,{user:n})]})]})})]})}s(100),s(101);function z(){var e=Object(c.useContext)(p),t=(e.user,e.setUser),s=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(S.g)(),a=function(e){null===e||void 0===e||e.preventDefault(),function(){var e=Object(x.a)(f.a.mark((function e(){var c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("auth/login",{email:s.current.value,password:n.current.value});case 2:c=e.sent,r=c.data,t(r.user),u.set("token",r.token),u.set("user",r.user);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()};Object(c.useEffect)((function(){var e=function(e){13===e.keyCode&&a()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}));return Object(d.jsx)("div",{className:"login",children:Object(d.jsxs)("div",{className:"loginWrapper",children:[Object(d.jsx)(N.a,{position:"top-center",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),Object(d.jsxs)("div",{className:"loginLeft",children:[Object(d.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(d.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(d.jsx)("div",{className:"loginRight",children:Object(d.jsxs)("form",{className:"loginBox",onSubmit:a,children:[Object(d.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",type:"email",required:!0,ref:s}),Object(d.jsx)("input",{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",className:"loginInput",type:"password",required:!0,minLength:"6",ref:n}),Object(d.jsx)("button",{className:"loginButton",children:"\u767b\u9646"}),Object(d.jsx)("span",{className:"loginForgot",children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"}),Object(d.jsx)("button",{className:"loginRegisterButton",onClick:function(){r.push("/register")},children:"\u521b\u5efa\u65b0\u8d26\u53f7"})]})})]})})}s(102);function H(){var e=Object(c.useRef)(),t=Object(c.useRef)(),s=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(S.g)();return Object(d.jsx)("div",{className:"login",children:Object(d.jsxs)("div",{className:"loginWrapper",children:[Object(d.jsxs)("div",{className:"loginLeft",children:[Object(d.jsx)("h2",{className:"loginLogo",children:"Fujix"}),Object(d.jsx)("span",{className:"loginDesc",children:"\u7528\u7167\u7247\u5206\u4eab\u4f60\u7684\u751f\u6d3b"})]}),Object(d.jsx)("div",{className:"loginRight",children:Object(d.jsxs)("form",{className:"loginBox",onSubmit:function(c){(c.preventDefault(),e.current.value===s.current.value)?(function(){var s=Object(x.a)(f.a.mark((function s(){return f.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,w().post("auth/register",{username:t.current.value,password:e.current.value,email:n.current.value});case 3:s.sent,s.next=9;break;case 6:s.prev=6,s.t0=s.catch(0),console.log(s.t0);case 9:case"end":return s.stop()}}),s,null,[[0,6]])})));return function(){return s.apply(this,arguments)}}()(),r.push("/login")):alert("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u540c")},children:[Object(d.jsx)("input",{placeholder:"\u7528\u6237\u540d",className:"loginInput",ref:t,required:!0}),Object(d.jsx)("input",{placeholder:"\u90ae\u7bb1",className:"loginInput",ref:n,required:!0,type:"email"}),Object(d.jsx)("input",{placeholder:"\u5bc6\u7801",className:"loginInput",ref:e,type:"password",minLength:"6",required:!0}),Object(d.jsx)("input",{placeholder:"\u518d\u6b21\u786e\u8ba4\u5bc6\u7801",className:"loginInput",ref:s,type:"password",required:!0}),Object(d.jsx)("button",{className:"loginButton",type:"submit",children:"\u6ce8\u518c"}),Object(d.jsx)("button",{className:"loginRegisterButton",onClick:function(){r.push("/login")},children:"\u767b\u9646"})]})})]})})}var M=s(59),G=s(28),Q=(s(103),s(131));function X(){var e=Object(c.useContext)(p).user,t=Object(c.useState)(null),s=Object(j.a)(t,2),n=s[0],r=s[1],a=Object(c.useState)({}),i=Object(j.a)(a,2),o=i[0],l=i[1],u=o.username,b=o.city,m=o.from,O=o.desc;Object(c.useEffect)((function(){(function(){var t=Object(x.a)(f.a.mark((function t(){var s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.get("users/".concat(e._id));case 2:s=t.sent,l(s.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e,l]);var h=function(t){var s=Object(M.a)({userId:null===e||void 0===e?void 0:e._id},t);(function(){var t=Object(x.a)(f.a.mark((function t(){var c,r,a,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n){t.next=11;break}return c=new FormData,r=Date.now()+n.name,c.append("fileName",r),c.append("file",n),t.next=8,w.post("/upload",c);case 8:a=t.sent,i=a.data,s.profilePicture=i;case 11:return t.next=13,w.put("users/".concat(e._id),s);case 13:alert("\u4fdd\u5b58\u6210\u529f"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(){return t.apply(this,arguments)}})()()},v=function(){return Object(d.jsx)("div",{className:"form",children:Object(d.jsxs)("div",{className:"formWrapper",children:[Object(d.jsxs)("h2",{className:"heading",children:[Object(d.jsx)(W.a,{fontSize:"large"}),"\u8bbe\u7f6e"]}),Object(d.jsxs)("label",{htmlFor:"file",children:[n?Object(d.jsx)("img",{alt:"",className:"userImg",src:URL.createObjectURL(n)}):Object(d.jsx)("img",{src:o.profilePicture||"http://localhost:8800/images/person/noAvatar.png",alt:"",className:"userImg"}),Object(d.jsx)("input",{type:"file",id:"file",style:{display:"none"},accept:".png,.jpeg,.jpg",onChange:function(e){return r(e.target.files[0])}})]}),Object(d.jsx)(G.c,{initialValues:{username:u,city:b,from:m,desc:O},onSubmit:h,children:Object(d.jsxs)(G.b,{className:"formBasic",children:[Object(d.jsx)("label",{htmlFor:"username",children:"\u7528\u6237\u540d\u5b57"}),Object(d.jsx)(G.a,{id:"username",name:"username",autoComplete:"off",className:"fieldItem"}),Object(d.jsx)("label",{htmlFor:"desc",children:"\u7b80\u4ecb"}),Object(d.jsx)(G.a,{id:"desc",name:"desc",autoComplete:"off",className:"fieldItem"}),Object(d.jsx)("label",{htmlFor:"city",children:"\u57ce\u5e02"}),Object(d.jsx)(G.a,{id:"city",name:"city",autoComplete:"off",className:"fieldItem"}),Object(d.jsx)("label",{htmlFor:"from",children:"\u5bb6\u4e61"}),Object(d.jsx)(G.a,{id:"from",name:"from",autoComplete:"off",className:"fieldItem"}),Object(d.jsx)(Q.a,{variant:"contained",color:"primary",type:"submit",children:"\u4fdd\u5b58\u8bbe\u7f6e"})]})})]})})};return Object(d.jsxs)(J,{children:[Object(d.jsx)("div",{className:"sidebar"}),Object(d.jsx)("div",{className:"center",children:Object(d.jsx)(v,{})}),Object(d.jsx)("div",{className:"rightbar",children:Object(d.jsx)(T,{})})]})}s(104);function Y(){var e=Object(c.useContext)(p).user,t=function(e){var t=Object(c.useState)([]),s=Object(j.a)(t,2),n=s[0],r=s[1];return Object(c.useEffect)((function(){!function(){var t=Object(x.a)(f.a.mark((function t(){var s,c,n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.get(e);case 3:c=t.sent,n=null===(s=c.data)||void 0===s?void 0:s.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),r(n.filter((function(e){return void 0!=e.img}))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()()}),[e]),n}("posts/portfolio/".concat(null===e||void 0===e?void 0:e._id));return Object(d.jsxs)(J,{children:[Object(d.jsx)("div",{className:"imageWrapper",children:t.map((function(e){return Object(d.jsx)("img",{src:e.img,alt:"",className:"portfolioImg"},e._id)}))}),Object(d.jsx)(B,{})]})}function Z(){return Object(d.jsx)("div",{children:Object(d.jsx)("h1",{children:"404"})})}var $=function(){var e=Object(c.useContext)(p).user;return Object(d.jsx)(l.a,{children:Object(d.jsxs)(S.d,{children:[Object(d.jsxs)(S.b,{path:"/",exact:!0,children:[e&&Object(d.jsx)(K,{}),!e&&Object(d.jsx)(S.a,{to:"/login"})]}),Object(d.jsxs)(S.b,{path:"/login",children:[e&&Object(d.jsx)(S.a,{to:"/"}),!e&&Object(d.jsx)(z,{})]}),Object(d.jsxs)(S.b,{path:"/portfolio",children:[e&&Object(d.jsx)(Y,{}),!e&&Object(d.jsx)(S.a,{to:"/"})]}),Object(d.jsx)(S.b,{path:"/register",children:Object(d.jsx)(H,{})}),Object(d.jsxs)(S.b,{path:"/profile/:username",children:[e&&Object(d.jsx)(V,{}),!e&&Object(d.jsx)(S.a,{to:"/login"})]}),Object(d.jsxs)(S.b,{path:"/setting",children:[e&&Object(d.jsx)(X,{}),!e&&Object(d.jsx)(S.a,{to:"/login"})]}),Object(d.jsx)(S.b,{path:"*",children:Object(d.jsx)(Z,{})})]})})};s(105);r.a.render(Object(d.jsx)(m,{children:Object(d.jsx)($,{})}),document.getElementById("root"))},66:function(e,t,s){},91:function(e,t,s){},92:function(e,t,s){},93:function(e,t,s){},94:function(e,t,s){},95:function(e,t,s){},96:function(e,t,s){},97:function(e,t,s){},98:function(e,t,s){},99:function(e,t,s){}},[[106,1,2]]]);
//# sourceMappingURL=main.bf5a73e3.chunk.js.map